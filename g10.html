<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Choose Your Own Adventure Hub</title>
    <style>
        body {
            font-family: 'Times New Roman', serif;
            background-color: #f0f0e0;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
        }

        .story-container {
            background-color: #ffffff;
            border: 1px solid #d0d0c0;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        h1 {
            font-family: 'Georgia', serif;
            color: #5a2d0d;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        #storyText {
            font-size: 1.1em;
            margin-bottom: 25px;
            text-align: justify;
        }

        .search-container {
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        #storySearch {
            padding: 10px 15px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            width: 100%;
            box-sizing: border-box; /* Include padding in width */
            font-family: 'Times New Roman', serif;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .option-button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            text-align: left;
            transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-family: 'Times New Roman', serif;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        .option-button.story-select-button {
            background-color: #008CBA; /* Blue for story selection */
        }
        .option-button.story-select-button:hover {
            background-color: #007bb5;
        }


        .option-button:hover {
            background-color: #45a049;
            transform: translateY(-2px);
            box-shadow: 0 6px 10px rgba(0, 0, 0, 0.15);
        }

        .option-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .restart-button {
            background-color: #007bff;
            margin-top: 30px;
            align-self: center;
            width: fit-content;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1.1em;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .restart-button:hover {
            background-color: #0056b3;
        }

        .hidden {
            display: none;
        }

        /* Responsive adjustments */
        @media (max-width: 600px) {
            .story-container {
                padding: 15px;
                margin: 10px;
            }
            h1 {
                font-size: 1.8em;
            }
            #storyText {
                font-size: 1em;
            }
            .option-button, .restart-button {
                font-size: 0.9em;
                padding: 10px 15px;
            }
        }

        .name-input-group {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fcfcfc;
        }
        .name-input-group label {
            font-weight: bold;
            color: #5a2d0d;
        }
        .name-input-group input[type="text"] {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 1em;
            width: 100%;
            box-sizing: border-box;
            font-family: 'Times New Roman', serif;
        }
        .name-input-group .start-story-button {
            background-color: #28a745;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            font-family: 'Times New Roman', serif;
            align-self: flex-end; /* Align button to the right */
        }
        .name-input-group .start-story-button:hover {
            background-color: #218838;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="story-container">
        <h1 id="mainTitle">Choose Your Adventure</h1>
        <div id="searchContainer" class="search-container">
            <input type="text" id="storySearch" placeholder="Search stories...">
        </div>
        <p id="storyText"></p>
        <div id="optionsContainer" class="options-container">
            <!-- Buttons will be dynamically added here -->
        </div>
        <button id="restartButton" class="option-button restart-button hidden">Return to Story Selection</button>
    </div>

    <script>
        // Global variables to store custom names
        let heroName = "Elara";
        let heroineName = "Kael";
        let coachingCenterName = "Elite Coaching Center"; // New variable for custom story

        /*
         * HOW TO ADD NEW STORIES MANUALLY:
         *
         * 1. Define a unique ID for your new story (e.g., 'my_new_adventure_start').
         * This ID will be used in the `storySelection` options.
         *
         * 2. Create the story nodes within the `allStories` object. Each node is an object
         * with at least a `text` property and optionally `options` and a `title`.
         * Example:
         * my_new_adventure_start: {
         * title: "The Legend of the Lost City",
         * text: "You embark on a perilous journey to find the fabled Lost City of Eldoria. The path ahead forks...",
         * options: [
         * { text: "Take the mountain pass.", next: "my_new_adventure_mountain" },
         * { text: "Follow the river downstream.", next: "my_new_adventure_river" }
         * ]
         * },
         * my_new_adventure_mountain: {
         * text: "The mountain pass is treacherous. A rockslide blocks your way!",
         * options: [
         * { text: "Try to climb over the rocks.", next: "my_new_adventure_climb" },
         * { text: "Search for an alternate route.", next: "my_new_adventure_search" }
         * ]
         * },
         * // ... continue defining subsequent nodes (mountain, river, climb, search, etc.)
         *
         * 3. For endings, you can use existing `endGame_` or `winGame_` nodes, or create new ones:
         * my_new_adventure_win: {
         * text: "You found Eldoria! Riches and glory are yours!",
         * options: [] // No options means the story ends
         * },
         *
         * 4. Add your new story to the `storySelection` options list. Ensure the `next` property
         * matches the starting ID of your new story:
         * storySelection: {
         * // ... existing options ...
         * { text: "Start My New Adventure!", next: "my_new_adventure_start" }
         * // ...
         * }
         *
         * 5. If your story needs custom name inputs (like heroName, heroineName, coachingCenterName):
         * - Create an input node (e.g., `my_custom_story_input_names`).
         * - Set its `text` to prompt for names.
         * - In `storySelection`, point to this input node (`next: "my_custom_story_input_names"`).
         * - The `displayCustomNameInput` function handles setting `currentStoryId` and `currentSceneKey`
         * to `my_custom_story_true_start` after names are entered.
         * - Ensure your actual story starts with a `_true_start` suffix (e.g., `my_custom_story_true_start`).
         * - Use `{heroName}`, `{heroineName}`, `{coachingCenterName}` in your story text, and the `processText`
         * function will automatically replace them.
         *
         * REMEMBER: Ensure every node has a path to an ending (either by having no options or linking to an `endGame_` / `winGame_` node).
         */

        // Define ALL story nodes, grouped by main story
        const allStories = {
            storySelection: {
                title: "Choose Your Adventure",
                text: "Welcome, adventurer! Select a grand tale to embark upon:",
                options: [
                    { text: "A Student's Devotion (Custom Names)", next: "customlove5_input_names" }, // Geetha Govindam / Student-Madam plot
                    { text: "The Pursuit of Passion (Custom Names)", next: "customlove6_input_names" }, // 3 Idiots inspired
                    { text: "The Whispers of the Star-Crossed - A Tale of Forbidden Love", next: "love_start" },
                    { text: "Whispers of a Royal Heart - A Romantic Destiny (Custom Names)", next: "customlove1_input_names" },
                    { text: "Echoes in the Stardust - A Sci-Fi Romance (Custom Names)", next: "customlove2_input_names" },
                    { text: "A Love Rekindled - The Lost Letter (Custom Names)", next: "customlove3_input_names" },
                    { text: "Fates Entwined - A Modern Romance (Custom Names)", next: "customlove4_input_names" },
                    { text: "Cosmic Odyssey - Beyond the Known Stars", next: "cosmic_explore_start" },
                    { text: "Sci-Fi: Colony Crisis on Kepler-186f", next: "sci_fi_colony_start" },
                    { text: "Sci-Fi: The Temporal Anomaly", next: "sci_fi_temporal_start" },
                    { text: "Sci-Fi: Deep Space Salvage Mission", next: "sci_fi_salvage_start" },
                    { text: "Superhero: Spider-Man: Web of Decisions", next: "spiderman_start" },
                    { text: "Superhero: Avengers: Global Threat Protocol", next: "avengers_start" },
                    { text: "Superhero: The Phantom Thief of Gotham", next: "superhero_phantom_start" },
                    { text: "Fantasy: The Whispering Woods - A Quest for the Heartwood Amulet", next: "woods_start" },
                    { text: "Fantasy: The Obsidian Tower - Delve into a Forbidden Stronghold", next: "tower_start" },
                    { text: "Fantasy: The Shifting Sands - Uncover Secrets Beneath the Dunes", next: "sands_start" },
                    { text: "Fantasy: The Sunken City of A'quath - Explore an Underwater Mystery", next: "aquath_start" },
                    { text: "Fantasy: The Dragon's Hoard", next: "fantasy_dragon_start" },
                    { text: "Fantasy: Journey to the Crystal Caves", next: "fantasy_crystal_caves_start" },
                    { text: "Education: Journey Through Ancient Egypt", next: "edu_egypt_start" },
                    { text: "Education: The Wonders of the Human Body", next: "edu_human_body_start" },
                    { text: "Education: The Alchemist's Apprentice (Learn)", next: "learn_alchemist_start" },
                    { text: "Quiz: The Ultimate History Challenge", next: "quiz_history_start" },
                    { text: "Quiz: Science Whiz-Kid", next: "quiz_science_start" },
                    { text: "Period: The Case of the Missing Heiress (Victorian)", next: "period_victorian_start" },
                    { text: "Period: Pirate's Gold and Glory", next: "period_pirate_start" },
                    { text: "Win: The Grand Tournament", next: "win_tournament_start" },
                    { text: "Visit: The Floating City of Aeridor", next: "visit_aeridor_start" }
                ]
            },

            // --- NEW Customizable Love Story 5: A Student's Devotion (Inspired by Geetha Govindam / Student-Madam Plot) ---
            customlove5_input_names: {
                title: "A Student's Devotion",
                text: "For this tale of unexpected affection, please enter the student's name, the madam's name, and the coaching center's name.",
            },
            customlove5_true_start: {
                title: "A Student's Devotion",
                text: "{heroName}, a diligent student at the renowned {coachingCenterName}, finds himself increasingly captivated by his intelligent and charming madam, {heroineName}. One day after class, he stays behind to ask a question, his heart pounding.",
                options: [
                    { text: "Express admiration for her teaching, subtly hinting at deeper feelings.", next: "customlove5_admire_hint" },
                    { text: "Stick to the academic question, trying to appear nonchalant.", next: "customlove5_academic_question" }
                ]
            },
            customlove5_admire_hint: {
                text: "{heroineName} smiles, acknowledging your compliment but redirecting to the question. 'I appreciate your dedication, {heroName}. Now, about this formula...'. You feel a pang of disappointment but also a spark of determination.",
                options: [
                    { text: "Continue to find subtle ways to spend time with her after class.", next: "customlove5_subtle_time" },
                    { text: "Focus solely on studies, burying your feelings for now.", next: "customlove5_focus_studies" }
                ]
            },
            customlove5_academic_question: {
                text: "{heroineName} patiently answers your question, then dismisses you with a warm smile. You leave feeling a mix of relief and regret for not being bolder.",
                options: [
                    { text: "Decide to be more direct next time.", next: "customlove5_direct_next_time" },
                    { text: "Accept it was just a crush and move on.", next: "endGame_bittersweet_love" }
                ]
            },
            customlove5_subtle_time: {
                text: "You frequently ask for extra help, volunteer for class projects, and always manage to be the last student to leave {coachingCenterName}. {heroineName} begins to notice your consistent presence, sometimes sharing personal anecdotes or a brief laugh. One evening, she shares a concern about a difficult personal decision she's facing.",
                options: [
                    { text: "Offer your emotional support and a listening ear.", next: "customlove5_emotional_support" },
                    { text: "Offer practical advice related to her concern.", next: "customlove5_practical_advice" }
                ]
            },
            customlove5_focus_studies: {
                text: "You excel academically, but the unspoken feelings fester. You see {heroineName} less, and the opportunity for connection dwindles. You graduate, a top student, but with a lingering 'what if'.",
                options: [{ text: "End the story.", next: "endGame_bittersweet_love" }]
            },
            customlove5_direct_next_time: {
                text: "The next opportunity arises during a study session. You prepare a heartfelt speech, but as you approach, she's surrounded by other students. The moment passes.",
                options: [{ text: "End the story.", next: "endGame_failure_love" }]
            },
            customlove5_emotional_support: {
                text: "{heroineName} is touched by your empathy. She confides more in you, finding comfort in your presence. Your bond deepens beyond that of student and teacher. She asks for your opinion on a major life choice.",
                options: [
                    { text: "Give honest, heartfelt advice, putting her happiness first.", next: "customlove5_honest_advice" },
                    { text: "Suggest a solution that would keep her close to you.", next: "customlove5_selfish_advice" }
                ]
            },
            customlove5_practical_advice: {
                text: "Your practical advice helps her resolve the issue, and she thanks you, impressed by your maturity. However, the emotional connection you hoped for doesn't quite form. You remain a trusted student.",
                options: [{ text: "End the story.", next: "endGame_bittersweet_love" }]
            },
            customlove5_honest_advice: {
                text: "You advise her to follow her dreams, even if it means moving away. She's moved by your selflessness. Days later, she visits you, her eyes shining. 'I made my decision,' she says, 'And I realized you were the one I wanted to share it with. I'm staying, for now, if you'll have me.'",
                options: [{ text: "Confess your love fully.", next: "winGame_customlove5_love" }]
            },
            customlove5_selfish_advice: {
                text: "She sees through your thinly veiled attempt to keep her near. Though she thanks you, a subtle distance grows between you. She eventually makes a decision that takes her far away.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            winGame_customlove5_love: {
                text: "Your selfless devotion and unwavering affection won her heart. {heroName} and {heroineName}, the student and the madam of {coachingCenterName}, embark on a beautiful, unexpected journey of love, proving that true connections defy all expectations.",
                options: []
            },

            // --- NEW Customizable Love Story 6: The Pursuit of Passion (Inspired by 3 Idiots) ---
            customlove6_input_names: {
                title: "The Pursuit of Passion",
                text: "Enter your name (the idealistic student), your best friend's name (the cautious one), and the name of the girl you both admire (the spirited one).",
            },
            customlove6_true_start: {
                title: "The Pursuit of Passion",
                text: "{heroName}, a free-spirited student, believes in following passion, not prestige. Your best friend, {heroineName} (though male/female, they represent the cautious friend), always urges caution. You both attend a lecture by the brilliant, spirited {coachingCenterName} (representing a person or institution you both admire/are influenced by).",
                options: [
                    { text: "Challenge {coachingCenterName}'s traditional views on education.", next: "customlove6_challenge_views" },
                    { text: "Engage {coachingCenterName} in a discussion about innovation.", next: "customlove6_discuss_innovation" }
                ]
            },
            customlove6_challenge_views: {
                text: "{coachingCenterName} is initially annoyed, but your passionate argument sparks a debate that impresses some, including a curious glance from {heroineName}. Your cautious friend, however, is mortified.",
                options: [
                    { text: "Seek out {heroineName} to discuss your ideas further.", next: "customlove6_seek_heroine" },
                    { text: "Try to reconcile with your cautious friend.", next: "customlove6_reconcile_friend" }
                ]
            },
            customlove6_discuss_innovation: {
                text: "{coachingCenterName} is intrigued by your insights. You both share a mutual respect for progressive thinking. Your cautious friend observes, somewhat intimidated.",
                options: [
                    { text: "Work with {coachingCenterName} on a new project.", next: "customlove6_work_project" },
                    { text: "Encourage your cautious friend to join the conversation.", next: "customlove6_encourage_friend" }
                ]
            },
            customlove6_seek_heroine: {
                text: "{heroineName} is receptive, admiring your boldness. You spend hours discussing life, dreams, and the flaws in the system. A deep connection forms.",
                options: [
                    { text: "Confess your growing feelings for {heroineName}.", next: "customlove6_confess_feelings" }
                ]
            },
            customlove6_reconcile_friend: {
                text: "Your cautious friend is still worried about your future, urging you to conform. You realize your paths might diverge, but your bond of friendship remains.",
                options: [{ text: "End the story.", next: "endGame_bittersweet" }]
            },
            customlove6_work_project: {
                text: "Your collaboration with {coachingCenterName} is groundbreaking, earning recognition. You are successful, but the personal connection you yearned for with {heroineName} doesn't materialize.",
                options: [{ text: "End the story.", next: "endGame_bittersweet" }]
            },
            customlove6_encourage_friend: {
                text: "Your cautious friend joins, but feels overshadowed. They realize this path isn't for them. The friendship remains, but with a new understanding of your differences.",
                options: [{ text: "End the story.", next: "endGame_bittersweet" }]
            },
            customlove6_confess_feelings: {
                text: "{heroineName} admits she's been drawn to your unconventional spirit. Your love blossoms amidst the academic chaos, a testament to following your heart.",
                options: [{ text: "End the story.", next: "winGame_customlove6_love" }]
            },
            winGame_customlove6_love: {
                text: "{heroName} and {heroineName} find love in the pursuit of passion, inspiring others at {coachingCenterName} to question the norm. You prove that excellence follows, not precedes, passion, creating a life full of joy and meaningful connection.",
                options: []
            },


            // --- Customizable Love Story 1: Whispers of a Royal Heart ---
            customlove1_input_names: {
                title: "Whispers of a Royal Heart",
                text: "To begin this tale, please enter the names of your hero and heroine.",
            },
            customlove1_true_start: {
                title: "Whispers of a Royal Heart",
                text: "Noble {heroName} and captivating {heroineName} find yourselves drawn together across the divide of warring kingdoms. Tonight, a secret rendezvous in the ancient castle ruins under a full moon. Your love is a dangerous secret.",
                options: [
                    { text: "Share your deepest fears about the war.", next: "customlove1_deepfears" },
                    { text: "Embrace the moment, cherishing your limited time together.", next: "customlove1_embrace" }
                ]
            },
            customlove1_deepfears: {
                text: "{heroineName} confesses worries about an arranged marriage. {heroName} speaks of a risky peace proposal his father, the King, is considering, which could compromise his family.",
                options: [
                    { text: "Suggest elopement, leaving the kingdoms behind.", next: "customlove1_elope" },
                    { text: "Vow to work for peace, even if it means risking exposure.", next: "customlove1_workforpeace" }
                ]
            },
            customlove1_embrace: {
                text: "As you share a tender moment, a rustle in the shadows alerts you. A guard patrol is approaching the ruins! Their lanterns cast long, searching beams.",
                options: [
                    { text: "Hide quickly in the crumbling tower.", next: "customlove1_hide" },
                    { text: "Create a diversion for your beloved to escape, while you face the guards.", next: "customlove1_diversion" }
                ]
            },
            customlove1_hide: {
                text: "You press against the cold stone, hearts pounding, as the guards pass by, their voices fading. The close call makes the fragility of your love painfully clear.",
                options: [
                    { text: "Decide immediate elopement is the only choice.", next: "customlove1_elope" },
                    { text: "Commit to finding a way to peace, despite the danger.", next: "customlove1_workforpeace" }
                ]
            },
            customlove1_diversion: {
                text: "You kick a pile of loose stones, drawing the guards' attention. '{heroineName}, run!' you whisper. She disappears into the night. You are surrounded, captured by your own kingdom's forces, accused of treason.",
                options: [
                    { text: "Confess your love, hoping for mercy.", next: "customlove1_capture_confess" },
                    { text: "Invent a plausible cover story for your presence.", next: "customlove1_capture_lie" }
                ]
            },
            customlove1_elope: {
                text: "You agree to meet at the secluded Whisperwind Chapel in three nights, with minimal belongings. It's a leap of faith into an unknown future.",
                options: [
                    { text: "Secretly gather essential supplies and a disguise.", next: "customlove1_gather_supplies" },
                    { text: "Trust in love alone and go as you are.", next: "customlove1_trust_love" }
                ]
            },
            customlove1_workforpeace: {
                text: "You return to your respective courts, determined. {heroName} subtly influences his father, while {heroineName} discreetly sends coded messages to her mother, a powerful Duchess. A secret meeting is arranged between minor diplomats.",
                options: [
                    { text: "Attend the secret diplomatic talks, as a silent observer.", next: "customlove1_diplomacy_attend" },
                    { text: "Provide strategic information from the shadows.", next: "customlove1_diplomacy_shadows" }
                ]
            },
            customlove1_capture_confess: {
                text: "Your confession of forbidden love shocks your captors. They see it as a greater betrayal. You are thrown into the deepest dungeon, awaiting trial for high treason.",
                options: [
                    { text: "Await your inevitable fate.", next: "customlove1_dungeon_despair" },
                    { text: "Seek any means of escape.", next: "customlove1_dungeon_escape" }
                ]
            },
            customlove1_capture_lie: {
                text: "You fabricate a tale of investigating enemy movements. They are suspicious but grudgingly accept your story, keeping you under close watch. You are free, but your love is in even greater peril.",
                options: [
                    { text: "Attempt to send a coded message to {heroineName}.", next: "customlove1_send_message" },
                    { text: "Focus entirely on winning the war to prove your loyalty.", next: "customlove1_focus_war" }
                ]
            },
            customlove1_gather_supplies: {
                text: "You discreetly pack a small bag: a map to the border, some rations, and two small, sentimental family heirlooms. You head for the chapel under the cloak of night.",
                options: [
                    { text: "Journey to Whisperwind Chapel.", next: "customlove1_chapel_meet" }
                ]
            },
            customlove1_trust_love: {
                text: "With only the clothes on your back and love in your heart, you steal away from the castle. The journey is perilous, but your resolve is unwavering. You head for the chapel.",
                options: [
                    { text: "Journey to Whisperwind Chapel.", next: "customlove1_chapel_meet" }
                ]
            },
            customlove1_diplomacy_attend: {
                text: "The negotiations are tense. Your presence, though silent, reminds both sides of the personal stakes. A fragile understanding is reached, leading to a ceasefire. You lock eyes with {heroineName} across the negotiating table, a silent promise.",
                options: [
                    { text: "Continue fostering the peace, with newfound hope.", next: "winGame_customlove1_peace" }
                ]
            },
            customlove1_diplomacy_shadows: {
                text: "Your indirect influence isn't enough. The talks stall, mistrust re-emerges, and the ceasefire breaks. The war continues, and {heroName} and {heroineName}'s love remains a distant dream.",
                options: [{ text: "End the story.", next: "endGame_failure_love" }]
            },
            customlove1_dungeon_despair: {
                text: "Days turn into weeks. Hope dwindles. You hear rumors of the war escalating, and your beloved's kingdom suffering. Your love, a beacon, is extinguished by the darkness of your cell.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            customlove1_dungeon_escape: {
                text: "You notice a loose stone in your cell, revealing a small, damp passage. It's a risky escape, but freedom calls. You slip into the darkness, determined.",
                options: [
                    { text: "Escape through the passage.", next: "customlove1_escape_tunnel" }
                ]
            },
            customlove1_send_message: {
                text: "Your message reaches {heroineName}! She risks everything to send a reply: she will meet you near the Sunken Bridge, a neutral point, but only once more before her arranged marriage.",
                options: [
                    { text: "Go to the Sunken Bridge.", next: "customlove1_bridge_meet" },
                    { text: "Refuse the meeting; it's too risky now.", next: "customlove1_refuse_meet" }
                ]
            },
            customlove1_focus_war: {
                text: "You fight with renewed ferocity, proving your loyalty. You rise through the ranks, becoming a war hero, but the cost is immense. Your beloved is a distant memory, sacrificed for the kingdom.",
                options: [{ text: "End the story.", next: "endGame_bittersweet_love" }]
            },
            customlove1_chapel_meet: {
                text: "You arrive at the chapel. The moon illuminates the path, but {heroineName} is nowhere to be seen. A cold fear grips your heart. Did she make it? Or was she caught?",
                options: [
                    { text: "Wait, hope against hope.", next: "customlove1_wait_chapel" },
                    { text: "Investigate nearby, looking for signs.", next: "customlove1_investigate_chapel" }
                ]
            },
            customlove1_escape_tunnel: {
                text: "The tunnel is long and filled with unseen obstacles. You crawl for hours, finally emerging into a dense forest, far from the castle. You are free, but alone. Where is {heroineName}?",
                options: [
                    { text: "Attempt to find {heroineName}.", next: "customlove1_search_for_heroine" },
                    { text: "Seek refuge in a neutral village, giving up the search for now.", next: "customlove1_neutral_village" }
                ]
            },
            customlove1_bridge_meet: {
                text: "You meet {heroineName} at the Sunken Bridge. Her eyes are filled with despair. 'They know,' she whispers, 'My marriage is moved forward. This is our last goodbye.'",
                options: [
                    { text: "Plead with her to elope now, despite the risks.", next: "customlove1_plead_elope" },
                    { text: "Accept her fate, sharing one last, tearful embrace.", next: "customlove1_last_embrace" }
                ]
            },
            customlove1_refuse_meet: {
                text: "You decide against the meeting. Days later, you hear the news: {heroineName} has been wed to a foreign prince, securing a strategic alliance. Your chance is gone.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            customlove1_wait_chapel: {
                text: "Hours pass. The moon sets. {heroineName} never arrives. You are left alone, heartbroken, in the cold, empty chapel. Your love, a beautiful dream, is shattered.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            customlove1_investigate_chapel: {
                text: "You find a discarded ribbon, one {heroineName} always wore, near a hidden passage you both knew. A single, fresh rose lies beside it. A message: 'Go. I am safe. Remember me.'",
                options: [
                    { text: "Honor her wish and escape to a new life.", next: "winGame_customlove1_eloped_bittersweet" },
                    { text: "Search for her, defying her message.", next: "customlove1_search_for_heroine" }
                ]
            },
            customlove1_search_for_heroine: {
                text: "You risk everything, venturing into her kingdom. You find traces, rumors, but she is always one step ahead, or deliberately avoiding you for your safety. Your pursuit leads to increasing danger, culminating in a trap.",
                options: [{ text: "End the story.", next: "endGame_failure_love" }]
            },
            customlove1_neutral_village: {
                text: "You find peace in a small, neutral village, living a quiet life. The war eventually ends, but {heroineName}'s fate remains unknown. You live with the quiet regret of what could have been.",
                options: [{ text: "End the story.", next: "endGame_bittersweet_love" }]
            },
            customlove1_plead_elope: {
                text: "You plead with {heroineName} to run. She hesitates, torn between duty and love. Finally, she shakes her head, tears streaming down her face. 'I cannot. Too many lives depend on this alliance.'",
                options: [
                    { text: "Accept her decision, with a broken heart.", next: "customlove1_last_embrace" },
                    { text: "Try to convince her one last time.", next: "customlove1_plead_fail" }
                ]
            },
            customlove1_plead_fail: {
                text: "Your pleas fall on deaf ears. She breaks away, leaving you heartbroken at the bridge as she returns to her duties. Your love story ends here, tragically.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            customlove1_last_embrace: {
                text: "You share a final, desperate embrace. The future is uncertain, but for this moment, your love transcends the war. She disappears into the night, leaving you with a haunting memory.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            winGame_customlove1_peace: {
                text: "Your efforts bring about a lasting peace between the kingdoms. {heroName} and {heroineName} are finally free to be together, their love a symbol of unity and hope for a new era. Your story becomes a legend.",
                options: []
            },
            winGame_customlove1_eloped_bittersweet: {
                text: "You escape to a distant, peaceful land. You build a new life, always wondering about the fate of your former kingdoms. Your love thrives, a quiet triumph over conflict.",
                options: []
            },

            // --- Customizable Love Story 2: Echoes in the Stardust ---
            customlove2_input_names: {
                title: "Echoes in the Stardust",
                text: "For this tale of cosmic romance, enter the names of your space-faring hero and heroine.",
            },
            customlove2_true_start: {
                title: "Echoes in the Stardust",
                text: "On the desolate mining colony of Xylos, {heroName}, a gritty prospector, and {heroineName}, a brilliant xenobotanist, discover a shared passion for the cosmos... and each other. Tonight, a message about a 'forbidden zone' asteroid belt.",
                options: [
                    { text: "Propose a daring, secret expedition to the asteroid belt together.", next: "customlove2_secret_expedition" },
                    { text: "Focus on your assigned duties, discussing the belt later.", next: "customlove2_assigned_duties" }
                ]
            },
            customlove2_secret_expedition: {
                text: "The idea sparks excitement in {heroineName}'s eyes. You secretly prep a small, fast shuttle. The belt is dangerous, teeming with uncharted anomalies and patrol drones from the controlling 'Syndicate'.",
                options: [
                    { text: "Plot a course through dense asteroid fields to avoid detection.", next: "customlove2_dense_fields" },
                    { text: "Attempt a risky shortcut through a known but unstable wormhole.", next: "customlove2_wormhole_shortcut" }
                ]
            },
            customlove2_assigned_duties: {
                text: "You return to work, but the thought of {heroineName} and the belt lingers. Days later, a Syndicate patrol is dispatched to the belt. {heroineName} gives you a worried look; she knows they're after something specific.",
                options: [
                    { text: "Secretly follow the Syndicate patrol.", next: "customlove2_follow_syndicate" },
                    { text: "Stay on the colony, gathering intel from comms.", next: "customlove2_colony_intel" }
                ]
            },
            customlove2_dense_fields: {
                text: "Navigating the dense fields is a tense dance. Asteroids whiz by, and you narrowly evade Syndicate drones. You find a hidden, ancient alien derelict, the source of the anomaly. It's partially powered.",
                options: [
                    { text: "Board the alien derelict.", next: "customlove2_board_derelict" },
                    { text: "Scan for the relic from outside, without boarding.", next: "customlove2_scan_relic" }
                ]
            },
            customlove2_wormhole_shortcut: {
                text: "The wormhole twists space and time around you! You emerge not in the belt, but near a forbidden Syndicate research station. Alarms blare! Your shuttle is immediately targeted.",
                options: [
                    { text: "Attempt to escape the station's fire.", next: "customlove2_escape_fire" },
                    { text: "Try to transmit a distress signal.", next: "customlove2_distress_signal" }
                ]
            },
            customlove2_follow_syndicate: {
                text: "You tail the Syndicate patrol through the asteroid belt, using the terrain for cover. They lead you directly to a newly revealed, massive alien structure pulsating with energy. It's what they were after.",
                options: [
                    { text: "Launch a daring assault on the Syndicate forces.", next: "customlove2_assault_syndicate" },
                    { text: "Wait for an opportunity to sneak inside the structure.", next: "customlove2_sneak_structure" }
                ]
            },
            customlove2_colony_intel: {
                text: "You hack into Syndicate comms. You learn they've activated an ancient alien defense system within the asteroid. The Relic is inside, protected by deadly automated drones. {heroineName} looks desperate.",
                options: [
                    { text: "Try to override the defense system remotely.", next: "customlove2_override_remote" },
                    { text: "Convince {heroineName} to help you physically breach the defense.", next: "customlove2_breach_physical" }
                ]
            },
            customlove2_board_derelict: {
                text: "The alien derelict is vast and silent. Strange alien symbols line the corridors. You find a central chamber where alien machinery seems to cradle the Lost Relic, but a force field blocks access.",
                options: [
                    { text: "Attempt to disable the force field using alien tech.", next: "customlove2_disable_forcefield" },
                    { text: "Search for a bypass or alternative entry to the relic.", next: "customlove2_derelict_bypass" }
                ]
            },
            customlove2_scan_relic: {
                text: "Your scans confirm the Relic is inside the derelict, deeply embedded. Retrieving it without boarding seems impossible. However, the scans also reveal a weakness in the derelict's core structure.",
                options: [
                    { text: "Return to the colony for better tools to breach the derelict.", next: "customlove2_return_colony_tools" },
                    { text: "Attempt a risky external breach with current gear.", next: "customlove2_risky_breach" }
                ]
            },
            customlove2_escape_fire: {
                text: "You engage the station's defenses, pushing the shuttle to its limits. You barely manage to escape, but the shuttle is heavily damaged. You limp back to Xylos, having failed the mission.",
                options: [{ text: "End the story.", next: "endGame_failure_love" }]
            },
            customlove2_distress_signal: {
                text: "You manage to send a cryptic distress signal just before your shuttle explodes under fire. {heroineName} receives it on Xylos, knowing you're in trouble. She embarks on a desperate solo rescue mission.",
                options: [{ text: "End the story.", next: "endGame_tragic_love_heroine_rescue" }] // Leads to heroine's own arc/ending
            },
            customlove2_assault_syndicate: {
                text: "You launch a surprise attack! The Syndicate forces are caught off guard, but they quickly recover. A fierce space battle ensues. Your small shuttle is no match for their armada. Your final transmission to {heroineName} is cut short.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            customlove2_sneak_structure: {
                text: "You carefully observe the Syndicate's movements, waiting for an opening. You find a temporary blind spot in their patrols and slip into the massive alien structure undetected.",
                options: [
                    { text: "Explore the alien structure's interior.", next: "customlove2_explore_structure" }
                ]
            },
            customlove2_override_remote: {
                text: "You spend days hunched over consoles on Xylos, {heroineName} at your side, feeding you data. You manage a partial override! Some drones are deactivated, creating a small window of opportunity.",
                options: [
                    { text: "Go to the asteroid and manually exploit the override.", next: "customlove2_exploit_override" }
                ]
            },
            customlove2_breach_physical: {
                text: "{heroineName} agrees. Together, you plan a daring breach. You acquire advanced explosive charges and a heavy-duty drill. The risk is immense, but your bond makes you brave.",
                options: [
                    { text: "Initiate the physical breach of the asteroid defense.", next: "customlove2_physical_breach" }
                ]
            },
            customlove2_grab_escape: {
                text: "You grab the Relic! The derelict shudders violently. You race back to your shuttle with {heroineName}, narrowly escaping as the ancient vessel tears itself apart. You hold the Relic, and each other, a new future beckons.",
                options: [
                    { text: "Begin your new life together, far from Syndicate control.", next: "winGame_customlove2_eloped" }
                ]
            },
            customlove2_stabilize_derelict: {
                text: "You attempt to stabilize the derelict's power. {heroineName} points to a critical conduit. As you work, the derelict is engulfed by a Syndicate warship, which opens fire. There's no time left.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }]
            },
            customlove2_conduits: {
                text: "Navigating the glowing conduits, you encounter complex energy puzzles. {heroineName}'s expertise in xenobotany unexpectedly provides insight into the alien energy patterns. Together, you bypass the final defense to reach the core. The Relic pulses there.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_customlove2_cosmic_discovery" }
                ]
            },
            customlove2_master_control: {
                text: "You locate a master control panel. It requires a specific energy frequency to deactivate the core. You have only one chance.",
                options: [
                    { text: "Attempt to input a random energy frequency.", next: "customlove2_random_frequency" },
                    { text: "Search for clues about the correct frequency.", next: "customlove2_search_frequency" }
                ]
            },
            customlove2_disarm_drones: {
                text: "Working quickly with {heroineName}, you use your override to disarm several drones. The remaining ones are easily dealt with. You reach the Relic, just as the override expires.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_customlove2_cosmic_discovery" }
                ]
            },
            customlove2_dash_relic: {
                text: "You dash for the Relic, ignoring the drones. They reactivate faster than expected, swarming you. You grab the Relic, but are overwhelmed on the way out. {heroineName} escapes, but you are lost.",
                options: [{ text: "End the story.", next: "endGame_tragic_love_heroine_survives" }] // Specific tragic end
            },
            endGame_tragic_love_heroine_survives: {
                text: "You are overwhelmed. Your final sight is {heroineName} escaping with the Relic, fulfilling your joint mission, but leaving you behind in the cold vacuum of space. Your love ensures the Relic's safety.",
                options: [{ text: "End the story.", next: "endGame_bittersweet_love" }]
            },
            customlove2_fight_guards: {
                text: "You fight valiantly, but the Syndicate guards are too numerous and well-armed. You and {heroineName} are cornered and eventually subdued. Your mission ends in captivity.",
                options: [{ text: "End the story.", next: "endGame_failure_love" }]
            },
            customlove2_escape_physical: {
                text: "You manage to create a chaotic scene and find a hidden vent. You and {heroineName} narrowly escape, but the Relic remains in Syndicate hands. You are free, but empty-handed.",
                options: [{ text: "End the story.", next: "endGame_failure_love" }]
            },
            customlove2_random_frequency: {
                text: "You input a random frequency. The core overloads, sending a massive energy surge throughout the structure. The station begins to implode, taking you and {heroineName} with it.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            customlove2_search_frequency: {
                text: "You search the alien console for clues. {heroineName}'s xenobotanical knowledge helps you recognize a pattern related to interstellar nebulae. You input the correct frequency. The core powers down, revealing the Relic!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_customlove2_cosmic_discovery" }
                ]
            },
            winGame_customlove2_eloped: {
                text: "You and {heroineName} forge a new life on a peaceful, uncharted planet. Your love, born amidst the stars, shines brighter than any cosmic anomaly. You have each other, and the universe is your oyster.",
                options: []
            },
            winGame_customlove2_cosmic_discovery: {
                text: "You and {heroineName} retrieve the Lost Relic from the heart of the alien structure! Your combined efforts have secured an artifact that will change galactic history, and solidified a love that transcends the stars.",
                options: []
            },


            // --- NEW Customizable Love Story 3: A Love Rekindled - The Lost Letter ---
            customlove3_input_names: {
                title: "A Love Rekindled - The Lost Letter",
                text: "Enter your name (Hero) and the name of your former beloved (Heroine) to begin this heartfelt journey of reunion.",
            },
            customlove3_true_start: {
                title: "A Love Rekindled - The Lost Letter",
                text: "Years have passed since you, {heroName}, parted ways with {heroineName} due to a misunderstanding. Today, while cleaning out your attic, you stumble upon a forgotten, unopened letter in a dusty box. It's from {heroineName}.",
                options: [
                    { text: "Open and read the letter immediately.", next: "customlove3_read_letter" },
                    { text: "Hesitate, wondering if it's better left unread.", next: "customlove3_hesitate" }
                ]
            },
            customlove3_read_letter: {
                text: "The letter is dated from the day after your last fight. It's a heartfelt apology, explaining everything and confessing her continued love. At the end, it says: 'If you ever find this, meet me at the old oak tree by the river, where we first met, at sunset.'",
                options: [
                    { text: "Go to the old oak tree immediately.", next: "customlove3_go_oak_tree" },
                    { text: "Call her first, to see if she still feels the same.", next: "customlove3_call_first" }
                ]
            },
            customlove3_hesitate: {
                text: "The past floods your mind. The pain of the breakup, the lingering questions... You put the letter back, deciding some doors are best left closed. Years later, you still wonder.",
                options: [{ text: "End the story.", next: "endGame_bittersweet_love" }]
            },
            customlove3_go_oak_tree: {
                text: "Your heart pounding, you rush to the old oak tree. The sun is setting, casting long shadows. {heroineName} is standing there, looking out at the river, a wistful expression on her face. She hasn't seen you yet.",
                options: [
                    { text: "Approach her slowly, calling her name softly.", next: "customlove3_approach_softly" },
                    { text: "Run to her, embracing her without a word.", next: "customlove3_run_embrace" }
                ]
            },
            customlove3_call_first: {
                text: "You find her number, your hands trembling. You call. It rings once, twice, then a soft, familiar voice answers. 'Hello?' she says, unsure. You introduce yourself. There's a long silence.",
                options: [
                    { text: "Apologize and explain you found the letter.", next: "customlove3_explain_call" },
                    { text: "Ask if she remembers the oak tree.", next: "customlove3_ask_oak_call" }
                ]
            },
            customlove3_approach_softly: {
                text: "You call her name. She turns, her eyes widening in disbelief, then filling with tears. '{heroName}!' she whispers, and rushes into your arms. The years of separation melt away.",
                options: [
                    { text: "Share a long, tearful reunion.", next: "customlove3_reunion" }
                ]
            },
            customlove3_run_embrace: {
                text: "You rush towards her, wrapping her in a tight embrace. She gasps, then her body relaxes, returning the hug with equal fervor. 'You came,' she murmurs against your shoulder. The reunion is silent, yet speaks volumes.",
                options: [
                    { text: "Share a long, silent reunion.", next: "customlove3_reunion" }
                ]
            },
            customlove3_explain_call: {
                text: "You explain about the letter, your voice thick with emotion. She's quiet for a moment. 'The letter... I thought you'd never get it. Yes, I remember the oak tree. I go there sometimes. I... I still wish you'd come.'",
                options: [
                    { text: "Tell her you're coming now.", next: "customlove3_go_oak_tree_call" }
                ]
            },
            customlove3_ask_oak_call: {
                text: "You ask if she still remembers the old oak tree. There's a soft sigh. 'Yes, {heroName}, I do. Every sunset. Why?' Your heart leaps. This is it.",
                options: [
                    { text: "Tell her you're on your way.", next: "customlove3_go_oak_tree_call" }
                ]
            },
            customlove3_go_oak_tree_call: {
                text: "You hang up, a renewed sense of purpose filling you. You rush towards the old oak tree. The sun is just dipping below the horizon. {heroineName} is there, turning as you approach, a hopeful smile on her face.",
                options: [
                    { text: "Walk towards her, ready to rekindle your love.", next: "customlove3_reunion" }
                ]
            },
            customlove3_reunion: {
                text: "You talk for hours under the stars, catching up on lost time, clearing up every misunderstanding. The pain of the past recedes, replaced by the warmth of renewed affection. Your love story has found its second, stronger chapter.",
                options: [{ text: "End the story.", next: "winGame_customlove3_rekindled" }]
            },
            winGame_customlove3_rekindled: {
                text: "Your love, lost but now found, burns brighter than ever. You embark on a new life together, cherished memories paving the way for a future filled with rekindled hope and deep affection. A true second chance.",
                options: []
            },

            // --- NEW Customizable Love Story 4: Fates Entwined - A Modern Romance ---
            customlove4_input_names: {
                title: "Fates Entwined - A Modern Romance",
                text: "Enter your name (Hero) and the name of your beloved (Heroine) for this contemporary tale of destiny.",
            },
            customlove4_true_start: {
                title: "Fates Entwined - A Modern Romance",
                text: "{heroName} and {heroineName} keep bumping into each other in the most unlikely ways – the same coffee shop, a shared Uber, even at the supermarket checkout. It feels like fate, but are you brave enough to act on it?",
                options: [
                    { text: "Ask for {heroineName}'s number.", next: "customlove4_ask_number" },
                    { text: "Let fate guide your next encounter.", next: "customlove4_let_fate" }
                ]
            },
            customlove4_ask_number: {
                text: "You gather your courage and ask for her number. {heroineName} smiles, a little surprised, but writes it down for you. 'I hope we run into each other again,' she winks. Do you text her tonight?",
                options: [
                    { text: "Text her immediately, expressing your interest.", next: "customlove4_text_now" },
                    { text: "Wait a day or two, playing it cool.", next: "customlove4_wait_text" }
                ]
            },
            customlove4_let_fate: {
                text: "You leave it to fate. Days turn into weeks. You see {heroineName} once more, but she's with someone else. Your chance is gone.",
                options: [{ text: "End the story.", next: "endGame_failure_love" }]
            },
            customlove4_text_now: {
                text: "You text her a witty opening line. She replies almost instantly, laughing. The conversation flows effortlessly, leading to a spontaneous coffee date tomorrow.",
                options: [
                    { text: "Go on the coffee date.", next: "customlove4_coffee_date" }
                ]
            },
            customlove4_wait_text: {
                text: "You wait two days. When you finally text, her reply is polite but brief. 'Oh, hey! I'm pretty busy this week.' The spark seems to have faded.",
                options: [{ text: "End the story.", next: "endGame_bittersweet_love" }]
            },
            customlove4_coffee_date: {
                text: "The coffee date is a huge success. You laugh, share stories, and feel an undeniable connection. As you leave, {heroineName} suggests a second date: a walk in the park.",
                options: [
                    { text: "Accept and plan the park walk.", next: "customlove4_park_walk" }
                ]
            },
            customlove4_park_walk: {
                text: "During your walk, you stumble upon a community fair. You spend the afternoon playing games, sharing cotton candy, and just enjoying each other's company. You realize this is more than just fate; it's love.",
                options: [
                    { text: "Confess your growing feelings.", next: "customlove4_confess_feelings" }
                ]
            },
            customlove4_confess_feelings: {
                text: "You tell {heroineName} how you feel. Her eyes light up, and she admits she feels the same. The fair lights twinkle around you, celebrating your new beginning.",
                options: [{ text: "End the story.", next: "winGame_customlove4_modern" }]
            },
            winGame_customlove4_modern: {
                text: "Your paths, once randomly entwined, now walk together. {heroName} and {heroineName}'s modern romance blossoms into a beautiful, lasting love story, proving that sometimes, fate just needs a little nudge.",
                options: []
            },


            // --- Original Story: The Whispers of the Star-Crossed (No custom names here, focusing purely on romance) ---
            love_start: {
                title: "The Whispers of the Star-Crossed",
                text: "You are Elara/Kael, meeting secretly in the Moonlit Garden with your beloved, from the rival Kingdom of Solara. The air is thick with the tension of war, but here, only love matters.",
                options: [
                    { text: "Profess your love, risking everything.", next: "love_profess" },
                    { text: "Discuss your hopes for a peaceful future together.", next: "love_discuss_peace" }
                ]
            },
            love_profess: {
                text: "A tender moment hangs in the air, but is shattered by a sudden noise from the bushes. A Solaran patrol! Their shouts echo through the garden.",
                options: [
                    { text: "Hide together in the shadows.", next: "love_hide" },
                    { text: "Create a diversion for your beloved to escape, sacrificing yourself.", next: "love_diversion" }
                ]
            },
            love_discuss_peace: {
                text: "Your conversation is filled with shared dreams of a peaceful life, far from conflict. Suddenly, a patrol from your own kingdom appears, their weapons gleaming in the moonlight!",
                options: [
                    { text: "Pretend to be enemies, staging a skirmish.", next: "love_pretendenemies" },
                    { text: "Try to explain your secret meeting, hoping for understanding.", next: "love_explainmeeting" }
                ]
            },
            love_hide: {
                text: "You cling together, barely breathing, as the patrol's boots crunch nearby. They pass. The narrow escape makes it clear: this secret cannot continue forever.",
                options: [
                    { text: "Plan to elope, leaving the war behind.", next: "love_elopeplan" },
                    { text: "Seek a diplomatic way to end the war, for your love.", next: "love_endwarplan" }
                ]
            },
            love_diversion: {
                text: "You create a loud noise in the opposite direction, drawing the patrol away. Your beloved escapes into the night. You are quickly surrounded and captured, a traitor in their eyes.",
                options: [
                    { text: "Lie about your purpose, claiming innocence.", next: "love_capturelie" },
                    { text: "Reveal your true feelings and the reason for your meeting, hoping for understanding.", next: "love_capturereveal" }
                ]
            },
            love_pretendenemies: {
                text: "You stage a believable skirmish, exchanging feigned blows. The patrols clash briefly then separate, suspicious but convinced of your animosity. You are safe for now, but your hearts ache.",
                options: [
                    { text: "Plan to elope, seeking freedom together.", next: "love_elopeplan" },
                    { text: "Seek a diplomatic way to end the war, for your love.", next: "love_endwarplan" }
                ]
            },
            love_explainmeeting: {
                text: "You try to explain your peaceful intentions. Your own patrol is furious, accusing you of treason. Your beloved's patrol also grows agitated. A full skirmish breaks out, and your beloved is caught in the crossfire.",
                options: [
                    { text: "Fight desperately to protect your beloved.", next: "love_fightforlove" },
                    { text: "Surrender immediately, hoping to de-escalate the violence.", next: "love_surrender" }
                ]
            },
            love_elopeplan: {
                text: "You make a desperate plan: meet at the ancient border stone at dawn, leaving everything behind for love. It's risky, but the only way.",
                options: [
                    { text: "Gather supplies discreetly before you go.", next: "love_gathersupplies" },
                    { text: "Trust fate and just go, with nothing but hope.", next: "love_trustfate" }
                ]
            },
            love_endwarplan: {
                text: "You decide the only true solution is peace. You approach a trusted elder in your court, renowned for their wisdom and influence.",
                options: [
                    { text: "Propose a secret peace summit between high-ranking officials.", next: "love_peacesummit" },
                    { text: "Suggest a daring act of public diplomacy, even if it puts you at risk.", next: "love_diplomacy" }
                ]
            },
            love_capturelie: {
                text: "You concoct a convincing story of reconnaissance and intelligence gathering. They are suspicious, but release you under strict surveillance. Your every move is watched.",
                options: [
                    { text: "Secretly try to contact your beloved, despite the risks.", next: "love_contactsecret" },
                    { text: "Focus entirely on ending the war now, as a new priority.", next: "love_endwarplan" }
                ]
            },
            love_capturereveal: {
                text: "You declare your love and your desire for peace. They are shocked, then enraged. Such forbidden love is seen as the highest treason. You are immediately imprisoned.",
                options: [
                    { text: "Await your inevitable fate.", next: "love_imprisoned" },
                    { text: "Try to escape, fueled by your desire for freedom and your beloved.", next: "love_escape" }
                ]
            },
            love_fightforlove: {
                text: "You fight fiercely, a whirlwind of desperation, but numbers are against you. Your beloved is gravely injured in the chaos, and you are subdued. Tragedy strikes the Moonlit Garden.",
                options: [
                    { text: "Witness their last breath.", next: "love_tragicend" },
                    { text: "Refuse to give up, even as darkness closes in.", next: "love_refuse" }
                ]
            },
            love_surrender: {
                text: "You drop your weapon, hands raised. The patrols, momentarily confused, separate. Your beloved is quickly secured and taken back to their kingdom, and you are detained for questioning.",
                options: [
                    { text: "Cooperate fully with your interrogators, hoping to aid peace.", next: "love_cooperate" },
                    { text: "Remain silent, protecting any secrets about your beloved.", next: "love_silent" }
                ]
            },
            love_gathersupplies: {
                text: "You manage to acquire some hidden gold, a small, faded map of neutral lands, and a change of clothes. You head towards the border stone, prepared for the journey.",
                options: [
                    { text: "Proceed to the border stone.", next: "love_bordermeet" }
                ]
            },
            love_trustfate: {
                text: "You slip away in the dead of night, with nothing but the clothes on your back and the hope in your heart. You head towards the border stone, trusting that love will guide you.",
                options: [
                    { text: "Proceed to the border stone.", next: "love_bordermeet" }
                ]
            },
            love_peacesummit: {
                text: "The elder agrees to your bold proposal! Secret negotiations begin in a hidden neutral temple. It's slow and fraught with tension, but hope flickers for the first time in years.",
                options: [
                    { text: "Participate actively in the negotiations, risking exposure.", next: "love_summitactive" },
                    { text: "Monitor from the shadows, providing insights indirectly.", next: "love_summitshadows" }
                ]
            },
            love_diplomacy: {
                text: "You propose a daring, public exchange of hostages, with yourself offering to be the first collateral. It’s a huge risk, but could break the stalemate.",
                options: [
                    { text: "Go through with the exchange.", next: "love_hostageexchange" },
                    { text: "Back out, realizing the danger is too great.", next: "love_backout" }
                ]
            },
            love_contactsecret: {
                text: "Through a network of sympathetic contacts, you manage to send a coded message. Weeks pass in agonizing silence, then, a reply! Your beloved plans an escape from their confinement.",
                options: [
                    { text: "Aid their escape with a diversion or supplies.", next: "love_aidescape" },
                    { text: "Wait for a better, less risky opportunity to reunite.", next: "love_wait" }
                ]
            },
            love_imprisoned: {
                text: "Days turn into weeks. Hope dwindles with each passing sunset. You hear whispers of a tentative peace treaty being discussed, but you're a forgotten pawn in this game, your love a distant memory.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            love_escape: {
                text: "You meticulously devise a plan, bribing a disgruntled guard with a stolen heirloom. You slip out of your cell and make a daring dash for freedom, heading for the border.",
                options: [
                    { text: "Proceed to the border stone.", next: "love_bordermeet" }
                ]
            },
            love_tragicend: {
                text: "Your beloved succumbs to their grievous wounds, their hand weakly clutching yours. Their last words are of love, a whispered promise. You are left with immense grief and a burning hatred for the war that claimed them.",
                options: [
                    { text: "Devote your life to ending the war, in their memory.", next: "love_devotetopeace" },
                    { text: "Seek vengeance on those responsible, no matter the cost.", next: "love_revenge" }
                ]
            },
            love_refuse: {
                text: "You scream, struggling against your captors, desperate to reach your beloved. You are beaten unconscious. You wake up in a cold, dark cell, your beloved gone, the fight lost.",
                options: [
                    { text: "Try to escape.", next: "love_escape" }
                ]
            },
            love_cooperate: {
                text: "You answer questions truthfully, revealing your true intentions for peace and your love. They are skeptical at first, but your sincerity slowly wins over some hearts. You become an unlikely envoy.",
                options: [
                    { text: "Work tirelessly for peace between the kingdoms.", next: "love_workforpeace" }
                ]
            },
            love_silent: {
                text: "Your silence is met with harsh interrogation. You endure, but eventually, under duress, you inadvertently reveal information. You emerge a broken shell, the secrets of your love compromised.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            love_bordermeet: {
                text: "You arrive at the ancient border stone, its weathered surface scarred by centuries of conflict. Your heart pounding in your chest. Is your beloved here?",
                options: [
                    { text: "Wait patiently, scanning the horizon.", next: "love_waitpatiently" },
                    { text: "Search for any signs or signals they might have left.", next: "love_searchsigns" }
                ]
            },
            love_summitactive: {
                text: "Your direct involvement strengthens the resolve for peace. After arduous talks and delicate compromises, a historic treaty is signed! You find your beloved among the delegates, their eyes meeting yours across the grand hall.",
                options: [
                    { text: "Embrace your beloved, a new era dawning.", next: "winGame_love_peace" }
                ]
            },
            love_summitshadows: {
                text: "Peace talks falter without your direct, influential input. The war drags on, a weary stalemate. Your beloved remains distant, their fate unknown.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            love_hostageexchange: {
                text: "The exchange is fraught with tension. As you cross the demarcation line, your beloved is there, eyes wide with relief and love. The moment of peace is fleeting, but your reunion is real. The war continues, but you are together.",
                options: [
                    { text: "Begin a new life together in a neutral, distant land.", next: "winGame_love_eloped" }
                ]
            },
            love_backout: {
                text: "You hesitate, the danger too overwhelming. The exchange falls apart, and the war escalates, now fueled by mistrust. You realize you lost your one chance for a truly bold move.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            love_aidescape: {
                text: "You create a clever diversion – a staged fire or a false alarm – allowing your beloved to slip from their captivity. You meet on the outskirts of the city and flee together into the night.",
                options: [
                    { text: "Elope to a distant, peaceful land.", next: "winGame_love_eloped" }
                ]
            },
            love_wait: {
                text: "You wait, hoping for a better chance. But the kingdoms tighten their grip, communication becomes impossible. Your beloved's fate becomes a mystery, lost to the war.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            love_acceptedfate: {
                text: "You fade into obscurity in prison, your spirit broken. The war rages on outside, and your love becomes a distant, painful dream, never realized.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            love_devotetopeace: {
                text: "You become a fierce advocate for peace, rallying support, speaking passionately, sacrificing your personal happiness for the greater good. The war eventually ends, a fragile peace achieved, but your love story is a tragic footnote in history.",
                options: [
                    { text: "Live a life dedicated to peace, remembering your sacrifice.", next: "endGame_bittersweet" }
                ]
            },
            love_revenge: {
                text: "Your grief consumes you. You take up arms, leading a personal vendetta against the enemy forces. You achieve some brutal victories, but are eventually cut down in battle, consumed by the hatred that fueled you.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            love_workforpeace: {
                text: "You tirelessly negotiate, building bridges between the estranged kingdoms, proving your loyalty to a higher cause. Your sincerity slowly wins over even the most stubborn hearts. A fragile peace is forged. You meet your beloved again at the treaty signing, older but wiser, united by a shared purpose.",
                options: [
                    { text: "Renew your vows for peace and love.", next: "winGame_love_peace" }
                ]
            },
            love_despair: {
                text: "Broken by your ordeal and the loss of your beloved, you waste away in prison. The war continues its relentless march outside, indifferent to your suffering.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            love_waitpatiently: {
                text: "Hours pass, agonizingly slowly. Just as despair begins to set in, a figure emerges from the treeline. It's your beloved! They made it, against all odds!",
                options: [
                    { text: "Embrace your beloved, your future beginning now.", next: "winGame_love_eloped" }
                ]
            },
            love_searchsigns: {
                text: "You search near the border stone and find a small, hidden message etched into a rock: 'Wait for me.' It gives you a surge of hope. You wait.",
                options: [
                    { text: "Wait patiently.", next: "love_waitpatiently" }
                ]
            },
            winGame_love_peace: {
                text: "A lasting peace is forged between your kingdoms, a testament to your love and sacrifice. You and your beloved are united, not just in love, but in a shared vision for a better, peaceful world. Your story becomes a legend.",
                options: []
            },
            winGame_love_eloped: {
                text: "You escape to a beautiful, neutral land, far from the war's reach. You build a new life together, away from the politics and conflict. Your love story, a secret legend, flourishes in peace.",
                options: []
            },

            // --- Sci-Fi Story: Cosmic Odyssey - Beyond the Known Stars ---
            cosmic_explore_start: {
                title: "Cosmic Odyssey - Beyond the Known Stars",
                text: "Your deep-space vessel, the 'Voyager', detects a faint, ancient signal from an uncharted nebula. It pulses with a rhythm unknown to any known civilization. Do you investigate?",
                options: [
                    { text: "Divert course and investigate the signal.", next: "cosmic_explore_nebulainvestigate" },
                    { text: "Maintain course, prioritizing mission objectives.", next: "cosmic_explore_maintaincourse" }
                ]
            },
            cosmic_explore_nebulainvestigate: {
                text: "You carefully navigate the nebula's ethereal currents. The signal strengthens, leading you to a colossal, derelict alien vessel, half-swallowed by the cosmic dust. It's a type of ship never before recorded.",
                options: [
                    { text: "Hail the derelict ship.", next: "cosmic_explore_hail" },
                    { text: "Initiate docking procedures.", next: "cosmic_explore_dock" }
                ]
            },
            cosmic_explore_maintaincourse: {
                text: "You ignore the anomaly, focusing on your planned route. Days later, you receive a distress call: a nearby colony is under attack by an unknown alien force, emanating from the very nebula you avoided. Your decision had consequences.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            cosmic_explore_hail: {
                text: "Your hails go unanswered, swallowed by the void. As you prepare to move closer, a faint, garbled message echoes back: '...intruders... awake...'. The ship hums with dormant power.",
                options: [
                    { text: "Proceed with docking, cautiously.", next: "cosmic_explore_dock" },
                    { text: "Maintain distance and scan for life signs.", next: "cosmic_explore_scanderelict" }
                ]
            },
            cosmic_explore_dock: {
                text: "You successfully dock with the derelict. The airlock hisses open to a dark, silent interior. Your lights reveal strange, alien architecture and signs of a long-dead civilization. You enter a grand hall.",
                options: [
                    { text: "Explore the grand hall.", next: "cosmic_explore_grandhall" },
                    { text: "Search for the bridge or command center.", next: "cosmic_explore_bridge" }
                ]
            },
            cosmic_explore_scanderelict: {
                text: "Your scans detect no active life signs, only residual energy readings consistent with the ancient signal. However, a small, hidden access panel is revealed on the hull, leading to a restricted area.",
                options: [
                    { text: "Attempt to force open the access panel.", next: "cosmic_explore_forcepanel" },
                    { text: "Abort and proceed with mission.", next: "endGame_failure" }
                ]
            },
            cosmic_explore_grandhall: {
                text: "The hall is vast and echoing. Murals depict cosmic events and advanced alien technology. In the center stands a large, unlit crystal altar. Strange symbols glow faintly on the floor around it.",
                options: [
                    { text: "Attempt to activate the altar's symbols.", next: "cosmic_explore_activatealtar" },
                    { text: "Search the hall for hidden passages.", next: "cosmic_explore_searchhall" }
                ]
            },
            cosmic_explore_bridge: {
                text: "You navigate through dark corridors until you find the bridge. Consoles are dead, but one terminal flickers to life, displaying a cryptic alien log about 'The Nexus Heart' and a 'cycle of awakening.'",
                options: [
                    { text: "Try to decipher the alien log.", next: "cosmic_explore_decipherlog" },
                    { text: "Attempt to restore power to the ship.", next: "cosmic_explore_restorepower" }
                ]
            },
            cosmic_explore_forcepanel: {
                text: "The panel resists. With a burst of energy, it blows open, triggering internal alarms throughout the derelict. Dormant security drones activate, converging on your position. You're ambushed!",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            cosmic_explore_activatealtar: {
                text: "You touch the symbols. The altar flares with light, projecting a holographic map of the galaxy. It highlights a system far beyond known space, pulsing with the same energy as the relic.",
                options: [
                    { text: "Follow the map to the highlighted system.", next: "cosmic_explore_followmap" },
                    { text: "Try to gain more information from the altar.", next: "cosmic_explore_altarinfo" }
                ]
            },
            cosmic_explore_searchhall: {
                text: "You find a hidden door, disguised as part of the mural. It slides open silently, revealing a narrow, spiraling passage descending into the ship's lower decks.",
                options: [
                    { text: "Descend into the lower decks.", next: "cosmic_explore_lowerdecks" }
                ]
            },
            cosmic_explore_decipherlog: {
                text: "The log is fragmented, but you piece together that 'The Nexus Heart' is the ship's core, currently in a dormant cycle. It requires a specific energy frequency to fully awaken, and the relic is tied to this process.",
                options: [
                    { text: "Search for a way to provide the energy frequency.", next: "cosmic_explore_energyfrequency" },
                    { text: "Bypass the awakening and try to locate the relic manually.", next: "cosmic_explore_manualrelic" }
                ]
            },
            cosmic_explore_restorepower: {
                text: "You attempt to re-route auxiliary power. Sparks fly, and the ship's life support flickers on, then off. Suddenly, the derelict's primary weapon systems power up, locking onto your ship! It misidentified you as a threat.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            cosmic_explore_followmap: {
                text: "You set course for the distant system, a journey of many parsecs. You arrive at a rogue planet, cloaked in an energy field. Scans confirm the Relic is within its core.",
                options: [
                    { text: "Attempt to breach the energy field.", next: "cosmic_explore_breachfield" },
                    { text: "Search for a natural weakness or access point on the planet.", next: "cosmic_explore_planetweakness" }
                ]
            },
            cosmic_explore_altarinfo: {
                text: "You try to extract more data, but the altar overloads, sending a mental shockwave through your mind. You reel back, disoriented and unable to use the altar again.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            cosmic_explore_lowerdecks: {
                text: "The lower decks are a maze of cargo bays and engineering sections. You stumble upon a massive, preserved alien cryo-chamber. One of the occupants stirs, its eyes glowing faintly. It's a sentinel.",
                options: [
                    { text: "Attempt to reactivate the sentinel fully, hoping it's a guide.", next: "cosmic_explore_reactivatesentinel" },
                    { text: "Attempt to sneak past the sentinel.", next: "cosmic_explore_sneaksentinel" }
                ]
            },
            cosmic_explore_energyfrequency: {
                text: "You search the bridge for the required frequency. A hidden data chip contains the precise sequence. You input it into the main console. The entire derelict ship shudders, and its core, the 'Nexus Heart', awakens, revealing the Relic within its glowing center!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_cosmic_explore" }
                ]
            },
            cosmic_explore_manualrelic: {
                text: "You try to manually access the core chamber, bypassing the awakening. The ship's internal defenses, now partially active, detect your unauthorized access. Force fields slam down, trapping you.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            cosmic_explore_breachfield: {
                text: "You fire your ship's energy weapons at the field. It holds, then retaliates with a powerful EMP blast. Your systems fry, and your ship drifts helplessly towards the planet's surface.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            cosmic_explore_planetweakness: {
                text: "You scan the planet extensively. You find a natural volcanic vent that seems to bypass the energy field and lead deep into the planet's crust. It's a dangerous descent.",
                options: [
                    { text: "Descend into the volcanic vent.", next: "cosmic_explore_volcanicvent" }
                ]
            },
            cosmic_explore_reactivatesentinel: {
                text: "You activate the sentinel. Its eyes glow brighter, and it stands. It turns its head slowly towards you, then points a multi-jointed arm towards a wall. A hidden door slides open, revealing a passage to the ship's core. The sentinel then deactivates.",
                options: [
                    { text: "Enter the passage to the core.", next: "cosmic_explore_energyfrequency" } // Leads to relic
                ]
            },
            cosmic_explore_sneaksentinel: {
                text: "You try to sneak past. The sentinel's head snaps towards you. It emits a piercing shriek, activating all other dormant sentinels in the chamber! You're surrounded.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            cosmic_explore_volcanicvent: {
                text: "Your ship plunges into the fiery depths of the vent. The heat is immense, and you narrowly avoid molten rock. You find a stable cavern deep within, where the Lost Relic pulses at the center of a crystal formation.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_cosmic_explore" }
                ]
            },
            winGame_cosmic_explore: {
                text: "You have completed your Cosmic Odyssey, retrieving a relic that will change the understanding of the universe! Your name is etched into galactic history.",
                options: []
            },

            // --- Sci-Fi Story 1: Colony Crisis on Kepler-186f ---
            sci_fi_colony_start: {
                title: "Colony Crisis on Kepler-186f",
                text: "You are Commander Aris, leader of the struggling human colony on Kepler-186f. A severe energy shortage threatens all life support systems, and a strange, aggressive alien flora is rapidly encroaching on the settlement.",
                options: [
                    { text: "Prioritize diverting remaining power to life support and basic needs.", next: "sci_fi_colony_lifesupport" },
                    { text: "Prioritize combating the alien flora with all available resources.", next: "sci_fi_colony_combatalien" }
                ]
            },
            sci_fi_colony_lifesupport: {
                text: "You redirect power. Essential systems stabilize, but the aggressive alien flora continues to spread, consuming solar arrays and threatening the colony walls. The air outside is now toxic with its spores.",
                options: [
                    { text: "Send a desperate plea for help to Earth, knowing it will take years.", next: "sci_fi_colony_plea" },
                    { text: "Organize a last-ditch effort to find an energy source within the colony.", next: "sci_fi_colony_search_energy" }
                ]
            },
            sci_fi_colony_combatalien: {
                text: "You mobilize the defense force against the flora. While you push it back, the energy reserves plummet. Lights flicker, life support falters. Panic spreads among the colonists.",
                options: [
                    { text: "Initiate emergency power-saving protocols, shutting down non-essential sectors.", next: "sci_fi_colony_powersave" },
                    { text: "Order the science team to rapidly find a weakness in the flora.", next: "sci_fi_colony_flora_weakness" }
                ]
            },
            sci_fi_colony_plea: {
                text: "The message is sent. Weeks turn into months. Supplies dwindle, and hope fades. The flora eventually breaches the weakened walls, overwhelming the colony.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            sci_fi_colony_search_energy: {
                text: "Your team uncovers an old, experimental geothermal generator in a forgotten sector. It's unstable, but could provide power. Activating it is risky.",
                options: [
                    { text: "Attempt to activate the geothermal generator.", next: "sci_fi_colony_activate_geo" },
                    { text: "Look for alternative, safer energy solutions (e.g., scavenging).", next: "sci_fi_colony_scavenge" }
                ]
            },
            sci_fi_colony_powersave: {
                text: "Non-essential sectors go dark. The colonists are cold and afraid, but power stabilizes. The flora is still a massive threat, but you've bought time. A lone scientist reports a strange shimmer near the flora's origin point.",
                options: [
                    { text: "Investigate the shimmer, hoping for a clue.", next: "sci_fi_colony_shimmer" }
                ]
            },
            sci_fi_colony_flora_weakness: {
                text: "The science team works tirelessly. They discover the flora is vulnerable to a specific sonic frequency, but creating the device will require rare materials and significant energy.",
                options: [
                    { text: "Divert all remaining power to build the sonic device.", next: "sci_fi_colony_build_sonic" },
                    { text: "Launch a desperate, manual assault on the flora's core.", next: "sci_fi_colony_manual_assault" }
                ]
            },
            sci_fi_colony_activate_geo: {
                text: "The generator sputters to life, then hums with immense power! The colony is saved from the energy crisis. With full power, you can now activate advanced defenses against the flora.",
                options: [
                    { text: "Direct power to activate flora repellents and burn zones.", next: "winGame_sci_fi_colony_saved" }
                ]
            },
            sci_fi_colony_scavenge: {
                text: "Your scavenging team finds minor power cells, enough to delay the inevitable for a few days, but not solve the crisis. The flora continues its advance.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            sci_fi_colony_shimmer: {
                text: "You investigate the shimmer. It leads to a hidden, ancient alien artifact, dormant but pulsating with a vast energy signature. It's intertwined with the flora's root system.",
                options: [
                    { text: "Attempt to interface with the alien artifact.", next: "sci_fi_colony_interface_artifact" },
                    { text: "Try to sever the flora's connection to the artifact.", next: "sci_fi_colony_sever_connection" }
                ]
            },
            sci_fi_colony_build_sonic: {
                text: "The colony pulls together, sacrificing comfort for survival. The sonic device is built just as the flora reaches the walls. You activate it. The alien plants recoil, wither, and die back! The crisis is averted!",
                options: [{ text: "End the story.", next: "winGame_sci_fi_colony_saved" }]
            },
            sci_fi_colony_manual_assault: {
                text: "A desperate manual assault. Armed colonists face the alien flora. It's a losing battle; the plants are too numerous and resilient. The colony falls.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            sci_fi_colony_interface_artifact: {
                text: "You cautiously interface with the artifact. It responds, revealing itself as a terraforming device. You learn to control the flora, turning it into a docile, breathable atmosphere generator.",
                options: [{ text: "End the story.", next: "winGame_sci_fi_colony_thrives" }]
            },
            sci_fi_colony_sever_connection: {
                text: "You sever the connection. The flora immediately goes wild, its growth accelerating uncontrollably. It bursts through the colony walls, consuming everything.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            winGame_sci_fi_colony_saved: {
                text: "The colony is saved! You've navigated impossible choices, ensuring the survival of humanity on Kepler-186f. Your leadership is legendary.",
                options: []
            },
            winGame_sci_fi_colony_thrives: {
                text: "Not only is the colony saved, but Kepler-186f blossoms into a lush, vibrant paradise under your guidance. Humanity thrives on this new, alien world, thanks to your profound understanding of its true nature.",
                options: []
            },

            // --- Sci-Fi Story 2: The Temporal Anomaly ---
            sci_fi_temporal_start: {
                title: "Sci-Fi: The Temporal Anomaly",
                text: "Your time-travel research lab detects a massive temporal anomaly. A ripple in history threatens to erase a pivotal moment. You must intervene, but every choice could create a new paradox.",
                options: [
                    { text: "Travel back to the source of the anomaly.", next: "sci_fi_temporal_source" },
                    { text: "Analyze the anomaly's effects from the present.", next: "sci_fi_temporal_analyze" }
                ]
            },
            sci_fi_temporal_source: {
                text: "You arrive in a chaotic past. The event is a grand invention, about to be destroyed. You must choose how to preserve it.",
                options: [
                    { text: "Protect the inventor directly.", next: "sci_fi_temporal_protect" },
                    { text: "Discreetly secure the blueprints.", next: "sci_fi_temporal_blueprints" }
                ]
            },
            sci_fi_temporal_analyze: {
                text: "Your analysis shows cascading failures throughout history. The anomaly is spreading, and time itself is unraveling. You need to act fast, but your window of opportunity is closing.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            sci_fi_temporal_protect: {
                text: "You intervene, saving the inventor and the invention, but your presence slightly alters the timeline. The future is subtly different, but stable.",
                options: [{ text: "End the story.", next: "endGame_bittersweet" }]
            },
            sci_fi_temporal_blueprints: {
                text: "You secure the blueprints. The invention is destroyed, but future scientists can rebuild it, albeit later. The timeline is preserved, but not without minor cost.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },

            // --- Sci-Fi Story 3: Deep Space Salvage Mission ---
            sci_fi_salvage_start: {
                title: "Sci-Fi: Deep Space Salvage Mission",
                text: "Your ship detects a distress beacon from a derelict freighter in an asteroid field. It could be valuable salvage, or a trap. Do you investigate?",
                options: [
                    { text: "Approach the freighter cautiously.", next: "sci_fi_salvage_approach" },
                    { text: "Ignore the beacon; too risky.", next: "endGame_failure" }
                ]
            },
            sci_fi_salvage_approach: {
                text: "You dock with the freighter. The interior is dark and eerie. A faint, unsettling hum can be heard.",
                options: [
                    { text: "Search the bridge for logs.", next: "sci_fi_salvage_logs" },
                    { text: "Head to the cargo bay for valuable loot.", next: "sci_fi_salvage_cargo" }
                ]
            },
            sci_fi_salvage_logs: {
                text: "The logs are corrupted, but you glimpse phrases like 'alien contamination' and 'containment breach'. A monstrous roar echoes from the cargo bay!",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            sci_fi_salvage_cargo: {
                text: "The cargo bay is filled with strange cocoons. One bursts open, revealing a grotesque alien creature! It lunges at you!",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },


            // --- Education Story 1: Journey Through Ancient Egypt ---
            edu_egypt_start: {
                title: "Education: Journey Through Ancient Egypt",
                text: "You've been transported back to Ancient Egypt! You stand before the majestic Great Pyramid of Giza. A friendly scribe, Imhotep, greets you. 'Welcome, stranger! Do you seek knowledge of our land?'",
                options: [
                    { text: "Ask about the purpose of the pyramids.", next: "edu_egypt_pyramids" },
                    { text: "Inquire about daily life in Ancient Egypt.", next: "edu_egypt_daily_life" }
                ]
            },
            edu_egypt_pyramids: {
                text: "Imhotep explains: 'The pyramids are grand tombs for our pharaohs, built to ensure their journey to the afterlife. The largest, the Great Pyramid, was built for Pharaoh Khufu.'",
                options: [
                    { text: "Ask about the afterlife beliefs.", next: "edu_egypt_afterlife" },
                    { text: "Inquire about the construction of the pyramids.", next: "edu_egypt_construction" }
                ]
            },
            edu_egypt_daily_life: {
                text: "Imhotep chuckles. 'Our lives revolve around the Nile River! It floods annually, bringing fertile soil for crops like wheat and barley. Most people are farmers, but there are also scribes, artisans, and priests.'",
                options: [
                    { text: "Ask about the Nile's importance.", next: "edu_egypt_nile" },
                    { text: "Ask about Egyptian food.", next: "edu_egypt_food" }
                ]
            },
            edu_egypt_afterlife: {
                text: "'We believe in a rich afterlife,' Imhotep explains. 'When a person dies, their soul journeys to the Duat, the underworld, where Osiris judges their heart against the Feather of Ma'at. Mummification preserves the body for this journey.'",
                options: [
                    { text: "Ask more about mummification.", next: "edu_egypt_mummification" },
                    { text: "Ask about prominent gods.", next: "edu_egypt_gods" }
                ]
            },
            edu_egypt_construction: {
                text: "'Ah, the construction! It took tens of thousands of skilled workers and laborers, not slaves, over many years. They used ramps and levers to move the massive stone blocks, which were quarried nearby.'",
                options: [
                    { text: "Ask about the tools used.", next: "edu_egypt_tools" },
                    { text: "Ask about the architects.", next: "edu_egypt_architects" }
                ]
            },
            edu_egypt_nile: {
                text: "'The Nile is the lifeblood of Egypt!' Imhotep gestures. 'Without its annual flood, our crops would not grow. It provides water, transport, and a source of fish and papyrus for writing.'",
                options: [
                    { text: "Ask about papyrus.", next: "edu_egypt_papyrus" },
                    { text: "Ask about transportation.", next: "edu_egypt_transportation" }
                ]
            },
            edu_egypt_food: {
                text: "'Our diet is simple but nourishing. Bread, beer, vegetables like onions and lentils, and fish from the Nile. Meat is reserved for special occasions,' Imhotep states.",
                options: [
                    { text: "Ask about Egyptian beer.", next: "edu_egypt_beer" },
                    { text: "Ask about special occasions.", next: "edu_egypt_occasions" }
                ]
            },
            edu_egypt_mummification: {
                text: "'It is a sacred process. First, the internal organs are removed and preserved in canopic jars. Then, the body is dried with natron salt for many days before being wrapped in layers of linen bandages,' Imhotep details.",
                options: [
                    { text: "Ask about canopic jars.", next: "edu_egypt_canopic" },
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_gods: {
                text: "'We worship many gods, each with their domain. Ra, the sun god, is supreme. Osiris judges the dead, Isis is the goddess of magic and motherhood, and Horus is the falcon-headed protector,' Imhotep recites.",
                options: [
                    { text: "Ask about a specific god (e.g., Anubis).", next: "edu_egypt_anubis" },
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_tools: {
                text: "'We use simple but effective tools: copper chisels, stone hammers, and ropes. For lifting, wooden levers and sledges are crucial,' Imhotep explains.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_architects: {
                text: "'The chief architect of the Great Pyramid was Hemiunu, the vizier of Pharaoh Khufu. His knowledge of mathematics and engineering was profound,' Imhotep says proudly.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_papyrus: {
                text: "'Papyrus is a plant that grows along the Nile. We process its stalks to create durable sheets for writing, painting, and even making sandals and boats,' Imhotep demonstrates with a small roll.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_transportation: {
                text: "'For long distances, especially along the Nile, we use boats made of papyrus or wood. For land travel, donkeys are common, and some noblemen have chariots,' Imhotep points to a passing boat.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_beer: {
                text: "'Our beer is thick and nutritious, a staple of our diet! It's made from fermented barley bread and water, and is safer to drink than unfiltered river water,' Imhotep offers a sample.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_occasions: {
                text: "'We have many festivals honoring our gods and pharaohs. The Opet Festival, celebrating Amun, is particularly grand, with parades and feasts,' Imhotep smiles.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_canopic: {
                text: "'The four canopic jars are sacred. Each lid is shaped like the head of one of Horus's sons: Imsety (human) for the liver, Hapy (baboon) for the lungs, Duamutef (jackal) for the stomach, and Qebehsenuef (falcon) for the intestines,' Imhotep explains, pointing to drawings.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            edu_egypt_anubis: {
                text: "'Anubis, the jackal-headed god, is the god of mummification and guardian of the dead. He guides souls through the underworld and presides over the weighing of the heart,' Imhotep clarifies.",
                options: [
                    { text: "Thank Imhotep for his knowledge.", next: "winGame_edu_egypt_learned" }
                ]
            },
            winGame_edu_egypt_learned: {
                text: "You've gained a fascinating insight into Ancient Egypt! Imhotep bids you farewell, hoping your journey back to your time is safe. You return, enriched with knowledge.",
                options: []
            },

            // --- Education Story 2: The Wonders of the Human Body ---
            edu_human_body_start: {
                title: "Education: The Wonders of the Human Body",
                text: "You've shrunk down to microscopic size and are ready to explore the human body! Where do you want to begin your journey?",
                options: [
                    { text: "Enter through the bloodstream.", next: "edu_human_body_bloodstream" },
                    { text: "Explore the digestive system.", next: "edu_human_body_digestive" }
                ]
            },
            edu_human_body_bloodstream: {
                text: "You are now floating in a river of red blood cells. White blood cells, like tiny guardians, patrol. The heart, a powerful pump, beats rhythmically in the distance.",
                options: [
                    { text: "Follow a white blood cell.", next: "edu_human_body_white_cell" },
                    { text: "Head towards the heart.", next: "edu_human_body_heart" }
                ]
            },
            edu_human_body_digestive: {
                text: "You find yourself in the esophagus, a muscular tube. Food particles are pushed down by waves of contractions. Ahead lies the churning stomach.",
                options: [
                    { text: "Continue into the stomach.", next: "edu_human_body_stomach" },
                    { text: "Exit the system (end exploration).", next: "endGame_general" }
                ]
            },
            edu_human_body_white_cell: {
                text: "The white blood cell leads you to a site of infection, where it bravely fights off invading bacteria. You witness the body's immune response in action!",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            edu_human_body_heart: {
                text: "You enter a chamber of the heart, witnessing the powerful contractions that pump blood throughout the body. The valves open and close with precise timing.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            edu_human_body_stomach: {
                text: "The stomach churns with strong acids and enzymes, breaking down food. It's a harsh environment, but essential for digestion.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },

            // --- Learn Story: The Alchemist's Apprentice ---
            learn_alchemist_start: {
                title: "Learn: The Alchemist's Apprentice",
                text: "You've stumbled upon the hidden workshop of Master Eldrin, a reclusive alchemist. He offers to teach you the basics. 'First,' he grunts, 'what is the most fundamental element in alchemy?'",
                options: [
                    { text: "A) Gold", next: "learn_alchemist_q1_wrong" },
                    { text: "B) Lead", next: "learn_alchemist_q1_wrong" },
                    { text: "C) Mercury", next: "learn_alchemist_q1_correct" }
                ]
            },
            learn_alchemist_q1_wrong: {
                text: "Incorrect! While important, it's not the most fundamental. Mercury is often considered the most volatile and transformative. Master Eldrin sighs, 'Perhaps this isn't for you.'",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            learn_alchemist_q1_correct: {
                text: "Correct! Mercury, the spirit. Now, for the next step: 'To purify a substance, what process is commonly used?'",
                options: [
                    { text: "A) Calcination", next: "learn_alchemist_q2_correct" },
                    { text: "B) Fermentation", next: "learn_alchemist_q2_wrong" },
                    { text: "C) Congelation", next: "learn_alchemist_q2_wrong" }
                ]
            },
            learn_alchemist_q2_wrong: {
                text: "Incorrect! Those are later steps or different processes. Calcination, the process of burning or roasting, is often the first step in purification. Master Eldrin shakes his head.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            learn_alchemist_q2_correct: {
                text: "Indeed, Calcination! You are a quick study. Eldrin smiles, 'You have potential, apprentice. Now, let us begin the real work.' You embark on a fascinating journey of learning alchemy.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },


            // --- Quiz Story 1: The Ultimate History Challenge ---
            quiz_history_start: {
                title: "Quiz: The Ultimate History Challenge",
                text: "Welcome, history buff! Answer three questions correctly to prove your mastery of the past. Question 1: Who was the first Emperor of Rome?",
                options: [
                    { text: "A) Julius Caesar", next: "quiz_history_q1_wrong_julius" },
                    { text: "B) Augustus", next: "quiz_history_q1_correct" },
                    { text: "C) Nero", next: "quiz_history_q1_wrong_nero" }
                ]
            },
            quiz_history_q1_wrong_julius: {
                text: "Incorrect! Julius Caesar was a powerful general, but never Emperor. Augustus was the first. Better luck next time. Your challenge ends.",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_history_q1_wrong_nero: {
                text: "Incorrect! Nero was an Emperor, but much later. Augustus was the first. Your historical journey ends here.",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_history_q1_correct: {
                text: "Correct! Augustus was indeed the first Emperor of Rome. On to Question 2: Which famous document begins with 'When in the Course of human events...'?",
                options: [
                    { text: "A) The U.S. Constitution", next: "quiz_history_q2_wrong_constitution" },
                    { text: "B) The Magna Carta", next: "quiz_history_q2_wrong_magna" },
                    { text: "C) The Declaration of Independence", next: "quiz_history_q2_correct" }
                ]
            },
            quiz_history_q2_wrong_constitution: {
                text: "Incorrect! That's the opening of the Declaration of Independence. Your quest for knowledge falters.",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_history_q2_wrong_magna: {
                text: "Incorrect! The Magna Carta is a different foundational document. The Declaration of Independence is correct. Try again another time.",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_history_q2_correct: {
                text: "Absolutely! The Declaration of Independence! You're on a roll! Question 3: What major event is considered the start of World War I?",
                options: [
                    { text: "A) The sinking of the Lusitania", next: "quiz_history_q3_wrong_lusitania" },
                    { text: "B) The assassination of Archduke Franz Ferdinand", next: "quiz_history_q3_correct" },
                    { text: "C) Germany's invasion of Poland", next: "quiz_history_q3_wrong_poland" }
                ]
            },
            quiz_history_q3_wrong_lusitania: {
                text: "Incorrect! The Lusitania sinking was a factor, but not the trigger. The assassination is correct. You almost made it!",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_history_q3_wrong_poland: {
                text: "Incorrect! Germany's invasion of Poland started WWII. WWI began differently. Your challenge ends.",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_history_q3_correct: {
                text: "Spot on! The assassination of Archduke Franz Ferdinand was the spark that ignited WWI! You have successfully completed The Ultimate History Challenge!",
                options: [{ text: "End the quiz.", next: "winGame_general" }]
            },

            // --- Quiz Story 2: Science Whiz-Kid ---
            quiz_science_start: {
                title: "Quiz: Science Whiz-Kid",
                text: "Time to test your scientific knowledge! Question 1: What is the chemical symbol for water?",
                options: [
                    { text: "A) Wo", next: "quiz_science_q1_wrong" },
                    { text: "B) H2O", next: "quiz_science_q1_correct" },
                    { text: "C) Wt", next: "quiz_science_q1_wrong" }
                ]
            },
            quiz_science_q1_wrong: {
                text: "Incorrect! The chemical symbol for water is H2O. Study up!",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_science_q1_correct: {
                text: "Correct! H2O is indeed water. Question 2: What force keeps us on the ground?",
                options: [
                    { text: "A) Magnetism", next: "quiz_science_q2_wrong" },
                    { text: "B) Friction", next: "quiz_science_q2_wrong" },
                    { text: "C) Gravity", next: "quiz_science_q2_correct" }
                ]
            },
            quiz_science_q2_wrong: {
                text: "Incorrect! It's gravity that keeps our feet on the ground. Keep experimenting!",
                options: [{ text: "End the quiz.", next: "endGame_failure" }]
            },
            quiz_science_q2_correct: {
                text: "That's right! Gravity! You're a true science whiz!",
                options: [{ text: "End the quiz.", next: "winGame_general" }]
            },


            // --- Period Story 1: The Case of the Missing Heiress (Victorian) ---
            period_victorian_start: {
                title: "Period: The Case of the Missing Heiress (Victorian)",
                text: "London, 1888. You are a renowned private investigator, accustomed to the city's murky underbelly. A frantic Lord Harrington bursts into your office: 'My daughter, Lady Amelia, has vanished! From a locked room!'",
                options: [
                    { text: "Go to the Harrington Manor immediately.", next: "period_victorian_manor" },
                    { text: "Question Lord Harrington for more details.", next: "period_victorian_question_lord" }
                ]
            },
            period_victorian_manor: {
                text: "The Manor is opulent but tense. The room where Lady Amelia vanished is on the second floor, a single window securely latched, the door locked from the inside. A maid reports seeing a shadowy figure nearby just before the disappearance.",
                options: [
                    { text: "Examine the locked room thoroughly.", next: "period_victorian_examine_room" },
                    { text: "Interview the maid about the shadowy figure.", next: "period_victorian_interview_maid" }
                ]
            },
            period_victorian_question_lord: {
                text: "Lord Harrington is distraught. He explains that Amelia was recently engaged to a Duke he disapproves of, and she had recently received anonymous threatening letters. He suspects foul play, perhaps from the Duke's enemies.",
                options: [
                    { text: "Go to the Manor, now with more context.", next: "period_victorian_manor" },
                    { text: "Investigate the Duke's background and enemies.", next: "period_victorian_duke_investigate" }
                ]
            },
            period_victorian_examine_room: {
                text: "You find no forced entry, but a faint scent of jasmine lingers. Beneath a loose floorboard, a tiny, intricately carved bird figurine is hidden. It feels like a clue.",
                options: [
                    { text: "Follow the jasmine scent.", next: "period_victorian_jasmine_scent" },
                    { text: "Investigate the bird figurine.", next: "period_victorian_bird_figurine" }
                ]
            },
            period_victorian_interview_maid: {
                text: "The maid, flustered, describes the figure as tall and cloaked, vanishing into the night fog. She also mentions Lady Amelia had a secret admirer who would leave jasmine flowers.",
                options: [
                    { text: "Connect this to the jasmine scent in the room.", next: "period_victorian_jasmine_scent" },
                    { text: "Search the grounds for any signs of the cloaked figure.", next: "period_victorian_search_grounds" }
                ]
            },
            period_victorian_duke_investigate: {
                text: "Your inquiries into the Duke reveal he has a powerful, vindictive rival, Lord Blackwood, known for his cunning and a strange fascination with rare birds. This seems promising.",
                options: [
                    { text: "Investigate Lord Blackwood's estate.", next: "period_victorian_blackwood_estate" },
                    { text: "Return to the Manor to re-examine the scene with this new lead.", next: "period_victorian_manor" }
                ]
            },
            period_victorian_jasmine_scent: {
                text: "The scent leads you to a hidden passage behind a bookshelf. It opens to a secret garden, bathed in moonlight, where a single jasmine bush thrives. You find a fresh set of footprints leading away.",
                options: [
                    { text: "Follow the footprints.", next: "period_victorian_follow_footprints" }
                ]
            },
            period_victorian_bird_figurine: {
                text: "The bird figurine is exquisitely crafted. You recall rumors of a secret society, 'The Ornithological League,' known for using such symbols. They are rumored to dabble in obscure sciences and secrets.",
                options: [
                    { text: "Investigate 'The Ornithological League'.", next: "period_victorian_ornithological" },
                    { text: "Connect this to Lord Blackwood's known interest in rare birds.", next: "period_victorian_blackwood_estate" }
                ]
            },
            period_victorian_search_grounds: {
                text: "The fog makes tracking difficult. You find a small, recently disturbed patch of earth near the garden wall, and a faint impression of a ladder. Amelia likely left on her own, or was aided to leave.",
                options: [
                    { text: "Realize she left willingly, or had an accomplice.", next: "period_victorian_secret_rendezvous" }
                ]
            },
            period_victorian_blackwood_estate: {
                text: "You discreetly stake out Blackwood Manor. You observe suspicious activity: a cloaked figure entering a hidden carriage at dawn, heading towards the docks. The carriage has a bird emblem.",
                options: [
                    { text: "Follow the carriage to the docks.", next: "period_victorian_follow_carriage" }
                ]
            },
            period_victorian_follow_footprints: {
                text: "The footprints lead to a secluded street corner where a private hansom cab has recently departed. The cabbie, when questioned, remembers picking up a 'young lady in a hurry' and a 'tall, cloaked gentleman.' They asked to be taken to a specific, out-of-the-way warehouse near the docks.",
                options: [
                    { text: "Proceed to the warehouse near the docks.", next: "period_victorian_warehouse" }
                ]
            },
            period_victorian_ornithological: {
                text: "Your contacts confirm The Ornithological League is linked to Blackwood. They collect rare artifacts and have a secret meeting place at a remote, abandoned aviary.",
                options: [
                    { text: "Go to the abandoned aviary.", next: "period_victorian_aviary" }
                ]
            },
            period_victorian_secret_rendezvous: {
                text: "You piece it together: Lady Amelia had a secret admirer, possibly the cloaked figure, who helped her escape. She didn't vanish; she eloped, or was spirited away by an accomplice. The jasmine, the bird, the discreet exit... it all points to a planned departure.",
                options: [
                    { text: "Focus your investigation on known locations for elopements or secret meetings.", next: "period_victorian_follow_carriage" }
                ]
            },
            period_victorian_follow_carriage: {
                text: "You follow the carriage to a dimly lit warehouse near the bustling docks. You see the cloaked figure and a veiled lady disembark. This is it.",
                options: [
                    { text: "Storm the warehouse.", next: "period_victorian_storm_warehouse" },
                    { text: "Infiltrate quietly to observe.", next: "period_victorian_infiltrate_warehouse" }
                ]
            },
            period_victorian_warehouse: {
                text: "You arrive at the damp, cold warehouse. You hear hushed voices inside. Through a crack in the door, you see Lady Amelia, unharmed, and the cloaked figure – revealed to be Lord Blackwood!",
                options: [
                    { text: "Confront them immediately.", next: "period_victorian_confront" },
                    { text: "Listen in for more information.", next: "period_victorian_listen" }
                ]
            },
            period_victorian_aviary: {
                text: "The abandoned aviary is crumbling but still holds cages. You find a hidden compartment containing documents about a plot to discredit Lord Harrington and marry Amelia to Blackwood, using forged letters and a staged 'disappearance.' Lady Amelia is here, a captive!",
                options: [
                    { text: "Rescue Lady Amelia.", next: "period_victorian_rescue_heiress" }
                ]
            },
            period_victorian_storm_warehouse: {
                text: "You burst in! Blackwood is startled. He tries to escape with Amelia, but you quickly subdue him. Amelia is safe, but traumatized by her ordeal.",
                options: [{ text: "End the story.", next: "winGame_period_victorian_rescue" }]
            },
            period_victorian_infiltrate_warehouse: {
                text: "You slip inside. Blackwood is trying to convince Amelia to marry him, revealing he staged her disappearance to prevent her marriage to the Duke. Amelia is distressed, but unharmed.",
                options: [
                    { text: "Reveal yourself and expose Blackwood's plot.", next: "period_victorian_confront" }
                ]
            },
            period_victorian_confront: {
                text: "You reveal yourself. Blackwood tries to bluster, but Lady Amelia, seeing you, stands firm. She confesses that she was initially tricked, but has since realized Blackwood's manipulation. Blackwood attempts to flee.",
                options: [
                    { text: "Subdue Blackwood.", next: "winGame_period_victorian_justice" }
                ]
            },
            period_victorian_listen: {
                text: "You overhear Blackwood explaining to Amelia that he staged her disappearance to save her from the 'corrupt' Duke, and that she is now his 'guest' until she agrees to marry him. Amelia is clearly unhappy.",
                options: [
                    { text: "Intervene and confront Blackwood.", next: "period_victorian_confront" }
                ]
            },
            period_victorian_rescue_heiress: {
                text: "You find Amelia, bound but unharmed. You quickly untie her. She explains Blackwood tricked her then imprisoned her to force marriage. You escape the aviary just as Blackwood's men arrive.",
                options: [{ text: "End the story.", next: "winGame_period_victorian_rescue" }]
            },
            winGame_period_victorian_rescue: {
                text: "Lady Amelia is safe, returned to her family. Lord Harrington is immensely grateful. You've solved the mystery and averted a scandalous forced marriage, solidifying your reputation as London's finest investigator!",
                options: []
            },
            winGame_period_victorian_justice: {
                text: "Lord Blackwood is arrested and his plot exposed, saving Lady Amelia from a terrible fate. Justice is served, and your reputation as a brilliant, ethical detective is cemented in the annals of London's finest cases.",
                options: []
            },

            // --- Period Story 2: Pirate's Gold and Glory ---
            period_pirate_start: {
                title: "Period: Pirate's Gold and Glory",
                text: "The year is 1718. You are a rookie on Blackbeard's fearsome ship, the 'Queen Anne's Revenge'. A merchant vessel is spotted! Blackbeard bellows, 'Prepare to board!'",
                options: [
                    { text: "Join the boarding party.", next: "period_pirate_board" },
                    { text: "Stay on deck, operating the cannons.", next: "period_pirate_cannons" }
                ]
            },
            period_pirate_board: {
                text: "You swing across to the merchant ship. Chaos erupts! You face off against a heavily armed sailor. You must act fast.",
                options: [
                    { text: "Engage in a sword fight.", next: "period_pirate_swordfight" },
                    { text: "Try to disarm him with a quick grapple.", next: "period_pirate_grapple" }
                ]
            },
            period_pirate_cannons: {
                text: "You load and fire a cannon, aiming for the enemy mast. Your shot is true, crippling their sails!",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            period_pirate_swordfight: {
                text: "Your blade clashes with his. After a tense duel, you disarm him. Blackbeard notices your skill.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            period_pirate_grapple: {
                text: "You grapple, but he's stronger! He throws you back, and you hit your head, losing consciousness.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },


            // --- Fantasy Story: The Whispering Woods Arc ---
            woods_start: {
                title: "The Whispering Woods",
                text: "The ancient Whispering Woods loom, their trees twisted into grotesque shapes, their air thick with magic. A faint, melancholic song drifts on the wind, leading you deeper.",
                options: [
                    { text: "Follow the song's melody.", next: "woods_melodysource" },
                    { text: "Look for a well-worn path, avoiding the deeper magic.", next: "woods_path" }
                ]
            },
            woods_melodysource: {
                text: "The song leads you to a clearing where an ethereal Dryad weeps by a withered ancient tree. She senses your presence. 'The Heartwood Amulet... stolen,' she whispers.",
                options: [
                    { text: "Offer to help the Dryad retrieve the amulet.", next: "woods_helpdryad" },
                    { text: "Ask for directions to the relic, ignoring her plight.", next: "woods_ignoredryad" }
                ]
            },
            woods_path: {
                text: "The path is safer but less enchanting. It leads to a rickety old bridge spanning a dark, silent chasm. Beyond, the forest thickens, and the air grows colder.",
                options: [
                    { text: "Cross the rickety bridge.", next: "woods_bridge" },
                    { text: "Search for a way to descend into the chasm.", next: "woods_chasm" }
                ]
            },
            woods_helpdryad: {
                text: "The Dryad gestures eastward. 'The Glimmerfang Goblins... they took it. Hidden in their warren beneath the Mossy Mound.' She imparts a blessing.",
                options: [
                    { text: "Head towards the Mossy Mound.", next: "woods_mound" }
                ]
            },
            woods_ignoredryad: {
                text: "The Dryad's mournful cries fade. You wander aimlessly for hours, the forest subtly redirecting your steps away from any clear path. You're lost.",
                options: [{ text: "End the story.", next: "woods_lost" }]
            },
            woods_bridge: {
                text: "Mid-way across, the bridge groans, and planks begin to splinter! You grab hold of a root as the bridge collapses below you. You manage to pull yourself to the other side.",
                options: [
                    { text: "Continue into the deeper forest.", next: "woods_deeperforest" }
                ]
            },
            woods_chasm: {
                text: "You find a narrow, winding path descending into the chasm's depths. Luminescent fungi illuminate ancient, jagged crystals. The air is still and heavy.",
                options: [
                    { text: "Explore the crystal caverns.", next: "woods_crystalcaverns" }
                ]
            },
            woods_mound: {
                text: "You find the Mossy Mound. A hidden crevice, just large enough, leads into darkness. You hear guttural goblin chatter.",
                options: [
                    { text: "Stealthily enter the goblin warren.", next: "woods_goblinstealth" },
                    { text: "Force your way in, ready for a fight.", next: "woods_goblinfight" }
                ]
            },
            woods_lost: {
                text: "Hours turn into a day. You're disoriented, hungry, and thirsty. The forest seems to close in. Eventually, you succumb to exhaustion and the wild.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            woods_deeperforest: {
                text: "The deeper forest is oppressive. You stumble upon a massive, hollowed-out tree. Inside, glowing runes pulse on the walls, leading to a hidden chamber. You feel a presence.",
                options: [
                    { text: "Enter the hollow tree.", next: "woods_hollowtree" }
                ]
            },
            woods_crystalcaverns: {
                text: "The crystals hum with a strange energy. A shimmering portal forms between two large crystals. It seems to lead elsewhere.",
                options: [
                    { text: "Step through the portal.", next: "shared_portalchamber" },
                    { text: "Ignore the portal and search for other exits.", next: "woods_caveexit" }
                ]
            },
            woods_goblinstealth: {
                text: "You move like a shadow. You find a central cavern. On a makeshift altar is the Heartwood Amulet. A large, snoring goblin stands guard.",
                options: [
                    { text: "Attempt to silently snatch the amulet.", next: "woods_snatchamulet" },
                    { text: "Create a diversion.", next: "woods_diversion" }
                ]
            },
            woods_goblinfight: {
                text: "You burst into the warren! A chaotic battle ensues. You fight valiantly, but their numbers overwhelm you. Their crude blades find their mark.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            woods_snatchamulet: {
                text: "Your movements are precise. You pluck the amulet. The goblin stirs, but you're already retreating into the shadows. You escape.",
                options: [
                    { text: "Return the amulet to the Dryad.", next: "woods_returnamulet" }
                ]
            },
            woods_diversion: {
                text: "You kick over loose rocks! The goblins rush to investigate. In the confusion, you grab the amulet and dash for the exit. You escape.",
                options: [
                    { text: "Return the amulet to the Dryad.", next: "woods_returnamulet" }
                ]
            },
            woods_returnamulet: {
                text: "The Dryad's tears turn to glittering dew. 'You have cleansed the blight. Now, seek the heart of the forest, where the eldest tree guards the path.' She shows you a hidden trail.",
                options: [
                    { text: "Enter the sunlit grove.", next: "woods_sunlitgrove" }
                ]
            },
            woods_sunlitgrove: {
                text: "You enter a breathtaking grove bathed in golden light. In the center, a colossal tree towers, its bark carved with ancient symbols. At its roots, you see the Lost Relic, humming softly.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_woods" }
                ]
            },
            woods_hollowtree: {
                text: "The glowing runes lead to a chamber filled with ancient forest spirits. They swirl around a pedestal, protecting it. One spirit gestures towards a pattern of glowing mushrooms.",
                options: [
                    { text: "Follow the mushroom pattern.", next: "woods_mushroompath" },
                    { text: "Attempt to communicate with the spirits.", next: "woods_communicatespirits" }
                ]
            },
            woods_mushroompath: {
                text: "You step on the glowing mushrooms in the correct sequence. The spirits part, and the pedestal reveals a hidden compartment. Inside, the Lost Relic waits!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_woods" }
                ]
            },
            woods_communicatespirits: {
                text: "You try to speak, but the spirits do not understand. Their swirling becomes erratic, forming a vortex. You are pulled into the heart of the tree, merging with the ancient wood.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            woods_caveexit: {
                text: "You ignore the portal and search. You find a narrow, unstable tunnel leading out. As you exit, the tunnel collapses behind you. You've escaped, but failed the quest.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            winGame_woods: {
                text: "Congratulations! You retrieved the Lost Relic from the Whispering Woods, restoring balance and claiming its power!",
                options: []
            },

            // --- The Obsidian Tower Arc ---
            tower_start: {
                title: "The Obsidian Tower",
                text: "The Obsidian Tower pierces the storm-laden sky, a dark monument of ancient, forbidden magic. A single, ominous gate, carved with screaming faces, marks its entrance.",
                options: [
                    { text: "Seek a hidden entrance.", next: "tower_hiddenentrance" },
                    { text: "Attempt to breach the main gate directly.", next: "tower_breachgate" }
                ]
            },
            tower_hiddenentrance: {
                text: "You skirt the tower's base, searching for cracks or weak points. You find a disguised entrance, hidden behind an illusion: a heavy stone slab with arcane symbols.",
                options: [
                    { text: "Attempt to deactivate the symbols.", next: "tower_symbols" },
                    { text: "Try to force open the slab.", next: "tower_forceslab" }
                ]
            },
            tower_breachgate: {
                text: "You approach the screaming gate. As you touch it, the faces awaken, their shrieks piercing your mind. Dark tendrils of magic lash out, draining your life force.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            tower_symbols: {
                text: "The symbols shift and writhe under your touch. After careful manipulation, the stone slab grinds open, revealing a dark, spiraling stairwell.",
                options: [
                    { text: "Descend the stairwell.", next: "tower_stairwell" }
                ]
            },
            tower_forceslab: {
                text: "You push against the slab. It resists, arcane energy pulses, throwing you back. The slab reseals itself, and a dark shadow descends upon you.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            tower_stairwell: {
                text: "The air grows heavy. You arrive in a large, circular chamber with three ornate doors: one of stone, one of iron, and one shimmering with magic.",
                options: [
                    { text: "Choose the stone door.", next: "tower_stonedoor" },
                    { text: "Choose the iron door.", next: "tower_irondoor" },
                    { text: "Choose the magical shimmering door.", next: "tower_magicdoor" }
                ]
            },
            tower_stonedoor: {
                text: "The stone door opens to a corridor lined with shifting sand. As you step, the sand beneath you shifts violently, attempting to drag you down.",
                options: [
                    { text: "Leap across the shifting sand to a stable platform.", next: "tower_leapsand" },
                    { text: "Try to walk slowly and carefully.", next: "tower_sinksand" }
                ]
            },
            tower_irondoor: {
                text: "The iron door leads to a dark armory filled with animated suits of armor. They clank and march towards you, swords drawn.",
                options: [
                    { text: "Engage the animated armor in combat.", next: "tower_armorcombat" },
                    { text: "Attempt to find a way to deactivate them.", next: "tower_deactivatearmor" }
                ]
            },
            tower_magicdoor: {
                text: "The shimmering door opens into a hall of mirrors. Your reflections twist, and one steps out, solidifying into a dark doppelganger of yourself.",
                options: [
                    { text: "Fight your doppelganger.", next: "tower_doppelgangerfight" },
                    { text: "Try to outsmart or trick your doppelganger.", next: "tower_doppelgangertrick" }
                ]
            },
            tower_leapsand: {
                text: "You leap, barely making it. You find yourself in a chamber with ancient mechanisms and glowing runes. The relic is close!",
                options: [
                    { text: "Examine the mechanisms.", next: "tower_mechanisms" }
                ]
            },
            tower_sinksand: {
                text: "You try to walk slowly, but the sand grips you tighter. You struggle, but are pulled deeper until submerged.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            tower_armorcombat: {
                text: "You strike at the armor, but it's incredibly resilient. More suits clank forward. You are eventually overwhelmed.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            tower_deactivatearmor: {
                text: "You notice a glowing sigil on a central pedestal. Touching it, the armor clatters to a halt, inert. The path is clear.",
                options: [
                    { text: "Proceed through the armory.", next: "tower_mechanisms" }
                ]
            },
            tower_doppelgangerfight: {
                text: "You engage your doppelganger. It matches your every move, predicting your attacks. It finds a weakness you didn't know you had. You fall.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            tower_doppelgangertrick: {
                text: "You try a psychological tactic. The doppelganger flickers, its confidence wavering. You realize it's a manifestation of your insecurities. As it hesitates, you strike true, dispelling it. The mirrors clear, revealing a passage.",
                options: [
                    { text: "Enter the passage.", next: "tower_mechanisms" }
                ]
            },
            tower_mechanisms: {
                text: "The chamber hums with ancient power. A complex array of gears, levers, and glowing crystals fill the room. A pedestal in the center clearly holds the Lost Relic, but a magical barrier protects it.",
                options: [
                    { text: "Attempt to solve the mechanism puzzle.", next: "tower_solvepuzzle" },
                    { text: "Try to force the magical barrier.", next: "tower_forcebarrier" }
                ]
            },
            tower_solvepuzzle: {
                text: "You carefully study the mechanisms. After much thought and careful adjustments, the magical barrier around the relic shimmers and dissipates.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_tower" }
                ]
            },
            tower_forcebarrier: {
                text: "You unleash your full strength against the magical barrier. It holds firm, but then retaliates with a blast of dark energy, vaporizing you instantly.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            winGame_tower: {
                text: "Victory! You have conquered the Obsidian Tower and claimed the Lost Relic, a prize of immense magical power!",
                options: []
            },

            // --- The Shifting Sands Arc ---
            sands_start: {
                title: "The Shifting Sands",
                text: "The scorching sun beats down on endless dunes. The air shimmers with heat, revealing faint outlines of colossal, sand-buried ruins. A hot, dry wind whips grains of sand across your face.",
                options: [
                    { text: "Head towards the largest ruin in the distance.", next: "sands_largestruin" },
                    { text: "Look for signs of ancient pathways or buried structures.", next: "sands_ancientpath" }
                ]
            },
            sands_largestruin: {
                text: "Hours of arduous travel bring you to the colossal ruin, a half-buried pyramid. Its entrance is a gaping maw of darkness, but the sand around it is unstable.",
                options: [
                    { text: "Attempt to enter the pyramid directly.", next: "sands_pyramidentrance" },
                    { text: "Search for a safer way around the quicksand.", next: "sands_avoidquicksand" }
                ]
            },
            sands_ancientpath: {
                text: "You scour the dunes for subtle clues. Eventually, you unearth a series of ancient, sun-bleached stepping stones, partially buried. They lead towards a less imposing, circular structure.",
                options: [
                    { text: "Follow the stepping stones.", next: "sands_steppingstones" }
                ]
            },
            sands_pyramidentrance: {
                text: "You step towards the entrance, and the ground beneath you gives way! You sink rapidly into a pit of quicksand, unable to find purchase. The sands claim you.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            sands_avoidquicksand: {
                text: "You spend time circling the pyramid, finding a narrow, rocky ridge that provides a stable path to a side entrance, barely visible.",
                options: [
                    { text: "Enter the side entrance.", next: "sands_pyramidside" }
                ]
            },
            sands_steppingstones: {
                text: "The stones lead you to a circular tomb, mostly buried. Its entrance is a single, heavy stone disk with a star chart carved into it. A faint hum emanates from inside.",
                options: [
                    { text: "Attempt to solve the star chart puzzle.", next: "sands_starchart" },
                    { text: "Try to force open the stone disk.", next: "sands_forcedisk" }
                ]
            },
            sands_forcedisk: {
                text: "You strain against the disk. A section of the ceiling crumbles, showering you with sand and debris. You're trapped and buried.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            sands_starchart: {
                text: "You carefully align the movable rings. With a soft click, the stone disk recedes into the earth, revealing a dark, descending passage.",
                options: [
                    { text: "Enter the passage.", next: "sands_descendingpassage" }
                ]
            },
            sands_pyramidside: {
                text: "The side entrance leads to a tight, dusty shaft. You slide down, emerging into a large, echoing antechamber. Hieroglyphs cover the walls, depicting guardians and a sarcophagus.",
                options: [
                    { text: "Examine the sarcophagus.", next: "sands_sarcophagus" },
                    { text: "Study the hieroglyphs for clues.", next: "sands_hieroglyphs" }
                ]
            },
            sands_sarcophagus: {
                text: "As you approach the sarcophagus, its lid slowly slides open. A cloud of ancient dust billows, and two glowing eyes open within. An undead Guardian rises!",
                options: [
                    { text: "Prepare for combat.", next: "sands_guardianfight" },
                    { text: "Attempt to escape the chamber.", next: "sands_escapeguardian" }
                ]
            },
            sands_hieroglyphs: {
                text: "The hieroglyphs tell a tale of a trapped spirit and a 'Key of the Sun' hidden within a false wall. One passage details how to appease the guardian.",
                options: [
                    { text: "Search for the 'Key of the Sun'.", next: "sands_searchkey" },
                    { text: "Attempt to appease the guardian (if it's already risen).", next: "sands_appeaseguardian" }
                ]
            },
            sands_guardianfight: {
                text: "The undead guardian is relentless. Its blows are heavy, and its ancient magic saps your strength. You fight to your last breath, but it is not enough. The desert claims another victim.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            sands_escapeguardian: {
                text: "You turn to flee, but the guardian is surprisingly fast. It blocks your exit, cornering you. Its cold grip closes around you.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            sands_searchkey: {
                text: "You tap along the walls, following the hieroglyphs' subtle hints. Behind a loose stone, you find a small, golden key shaped like a sun disc.",
                options: [
                    { text: "Use the key to open the sarcophagus.", next: "sands_opensarcophaguskey" }
                ]
            },
            sands_appeaseguardian: {
                text: "You perform the ancient gestures. The guardian's glow dims, and it returns to its slumber. A secret passage opens behind it.",
                options: [
                    { text: "Enter the secret passage.", next: "sands_secretpassage" }
                ]
            },
            sands_opensarcophaguskey: {
                text: "You insert the key. The lid slides open, revealing not a mummy, but a hidden compartment. Inside, glowing faintly, is the Lost Relic!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_sands" }
                ]
            },
            sands_secretpassage: {
                text: "The passage winds down into a vast, underground vault. Golden light emanates from the center, where the Lost Relic rests on a shimmering pedestal.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_sands" }
                ]
            },
            sands_descendingpassage: {
                text: "The passage leads you deep beneath the sands. You arrive in a cavern filled with ancient, unmoving automatons. In the center, the Lost Relic pulsates on an altar.",
                options: [
                    { text: "Attempt to sneak past the automatons.", next: "sands_sneakautomatons" },
                    { text: "Try to activate one of the automatons, hoping it's friendly.", next: "sands_activateautomaton" }
                ]
            },
            sands_sneakautomatons: {
                text: "You move with caution. One almost stirs, but you freeze. You reach the altar. The relic is yours!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_sands" }
                ]
            },
            sands_activateautomaton: {
                text: "You touch a glowing rune. Its eyes flare with a horrifying red glow. It recognizes you as an intruder and activates all its brethren. You are quickly overwhelmed.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            winGame_sands: {
                text: "Success! You have navigated the treacherous Shifting Sands and recovered the Lost Relic!",
                options: []
            },

            // --- The Sunken City of A'quath Arc ---
            aquath_start: {
                title: "The Sunken City of A'quath",
                text: "You stand at the edge of a deep, emerald-green trench. Legends speak of A'quath, a city swallowed by the sea, holding treasures beyond imagination, including the Relic. You prepare to dive.",
                options: [
                    { text: "Descend into the trench with basic diving gear.", next: "aquath_basicdive" },
                    { text: "Seek out a more advanced diving suit or submersible.", next: "aquath_seekgear" }
                ]
            },
            aquath_basicdive: {
                text: "The pressure is intense. You see glimpses of ancient, barnacle-covered buildings. Your air supply is dwindling, and strange, luminous creatures watch from the depths. A faint glow draws you deeper.",
                options: [
                    { text: "Follow the faint glow.", next: "aquath_followglow" },
                    { text: "Head back to the surface for more air.", next: "aquath_surfaceshort" }
                ]
            },
            aquath_seekgear: {
                text: "You spend days searching, finally locating a derelict, but functional, deep-sea submersible. Its controls are complex, but it promises a safer journey.",
                options: [
                    { text: "Board the submersible and descend.", next: "aquath_submersibledive" }
                ]
            },
            aquath_followglow: {
                text: "The glow leads you to a massive, crumbling archway. Beyond it, the city of A'quath truly begins, its grand structures eerily preserved. The air grows colder, and you feel watched.",
                options: [
                    { text: "Enter the city ruins.", next: "aquath_cityruins" }
                ]
            },
            aquath_surfaceshort: {
                text: "You barely make it back to the surface, gasping for air. The pressure has taken its toll, and you realize you're not equipped for this. You abandon the quest.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            aquath_submersibledive: {
                text: "The submersible descends smoothly. Through the viewport, you witness the majestic, eerie beauty of A'quath. It’s vast and silent. You see three main paths: a grand boulevard, a labyrinthine coral garden, and a dark, deep crevice.",
                options: [
                    { text: "Navigate the grand boulevard.", next: "aquath_boulevard" },
                    { text: "Explore the coral garden.", next: "aquath_coralgarden" },
                    { text: "Venture into the deep crevice.", next: "aquath_crevice" }
                ]
            },
            aquath_cityruins: {
                text: "The city is a maze of crumbling buildings. You encounter ancient, aquatic guardians – humanoid figures made of shimmering water and stone, silent but menacing.",
                options: [
                    { text: "Attempt to sneak past the guardians.", next: "aquath_sneakuardians" },
                    { text: "Prepare for combat with the guardians.", next: "aquath_fightguardians" }
                ]
            },
            aquath_sneakuardians: {
                text: "You use the ruined structures for cover, moving stealthily. One guardian turns its head, sensing you, but you freeze, and it passes. You reach a central temple.",
                options: [
                    { text: "Enter the temple.", next: "aquath_temple" }
                ]
            },
            aquath_fightguardians: {
                text: "You attack the aquatic guardians. Their bodies shift and reform, making them difficult to strike. Their watery grasp is surprisingly strong. You are eventually dissolved by their touch.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            aquath_boulevard: {
                text: "The boulevard leads to a massive, intact domed building, glowing faintly. It appears to be the central library or archives of A'quath. The entrance is sealed by a complex pressure lock.",
                options: [
                    { text: "Try to solve the pressure lock puzzle.", next: "aquath_pressurelock" },
                    { text: "Look for an alternate entry point (ventilation shaft, etc.).", next: "aquath_ventilation" }
                ]
            },
            aquath_coralgarden: {
                text: "The garden is beautiful but disorienting. Strange, luminescent plants pulse, and schools of fish glide by. You notice a hidden cave entrance, almost invisible amongst the coral.",
                options: [
                    { text: "Enter the hidden cave.", next: "aquath_hiddencave" }
                ]
            },
            aquath_crevice: {
                text: "The crevice descends into crushing darkness. Your submersible's lights struggle to penetrate. You hear strange, deep echoes. The pressure alarms begin to blare.",
                options: [
                    { text: "Continue deeper, hoping to find the relic.", next: "aquath_deepercrevice" },
                    { text: "Ascend immediately, the pressure is too great.", next: "aquath_ascendfail" }
                ]
            },
            aquath_pressurelock: {
                text: "You manipulate the ancient controls. After several attempts, the lock clicks open with a rush of water. You enter the library, filled with ancient scrolls and artifacts. In the center, on a rotating pedestal, is the Relic.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_aquath" }
                ]
            },
            aquath_ventilation: {
                text: "You find a small, corroded ventilation shaft. It's a tight squeeze, but you manage to navigate it. It leads you into a lower section of the library, bypassing the main lock. The Relic is in sight!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_aquath" }
                ]
            },
            aquath_hiddencave: {
                text: "The cave is narrow and twists, eventually opening into a hidden grotto. Here, the water is warmer, and the Lost Relic sits on a natural stone altar, radiating a soft, inviting light.",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_aquath" }
                ]
            },
            aquath_deepercrevice: {
                text: "The submersible groans under the pressure. Warning lights flash. Suddenly, a massive, unseen creature brushes against your vessel, crushing it like a tin can. You never stood a chance.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            aquath_ascendfail: {
                text: "You quickly ascend, barely escaping the crushing depths. The submersible is heavily damaged, and you realize the relic lies beyond your reach. You return to the surface, defeated.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            aquath_temple: {
                text: "Inside the temple, the water shimmers with a thousand lights. A grand altar stands in the center, and upon it, encased in a shimmering bubble, is the Lost Relic. Three orbs orbit the bubble, each glowing a different color.",
                options: [
                    { text: "Touch the blue orb.", next: "aquath_blueorb" },
                    { text: "Touch the red orb.", next: "aquath_redorb" },
                    { text: "Touch the green orb.", next: "aquath_greenorb" }
                ]
            },
            aquath_blueorb: {
                text: "Touching the blue orb makes the bubble around the relic glow brighter, and a pulse of energy pushes you back. It seems to strengthen the barrier.",
                options: [
                    { text: "Try another orb.", next: "aquath_temple" }
                ]
            },
            aquath_redorb: {
                text: "Touching the red orb causes a searing heat to emanate from the bubble, damaging your diving gear. You quickly recoil.",
                options: [
                    { text: "Try another orb.", next: "aquath_temple" }
                ]
            },
            aquath_greenorb: {
                text: "Touching the green orb causes the bubble to shimmer and fade away. The Lost Relic is now accessible!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_aquath" }
                ]
            },
            winGame_aquath: {
                text: "With a triumphant gasp, you surface, clutching the Lost Relic from the depths of A'quath. Its power feels immense!",
                options: []
            },

            // --- Fantasy Story: The Dragon's Hoard ---
            fantasy_dragon_start: {
                title: "Fantasy: The Dragon's Hoard",
                text: "Whispers of a colossal red dragon, Ignis, and its legendary hoard have reached your ears. The gold alone could rebuild your ruined village. You stand at the entrance to its volcanic lair.",
                options: [
                    { text: "Attempt to sneak past Ignis and grab some treasure.", next: "fantasy_dragon_sneak" },
                    { text: "Prepare to confront Ignis in battle.", next: "fantasy_dragon_confront" }
                ]
            },
            fantasy_dragon_sneak: {
                text: "The heat is immense. You see mountains of gold. Ignis is asleep, but one scale glints strangely. Reaching the gold means passing close to its head.",
                options: [
                    { text: "Grab a small bag of gold closest to the entrance.", next: "fantasy_dragon_grab_small" },
                    { text: "Attempt to take a large chest, closer to the dragon's head.", next: "fantasy_dragon_grab_large" }
                ]
            },
            fantasy_dragon_confront: {
                text: "You shout a challenge into the lair. Ignis's eyes snap open, twin pools of molten fire. It unfurls its immense wings, filling the cavern with its terrifying presence.",
                options: [
                    { text: "Engage the dragon head-on.", next: "fantasy_dragon_battle" },
                    { text: "Try to find a strategic weakness in the lair.", next: "fantasy_dragon_lair_weakness" }
                ]
            },
            fantasy_dragon_grab_small: {
                text: "You snatch a pouch of gold! Ignis stirs, but you're already sprinting out of the lair, the triumphant glint of gold in your hands. It's not enough to rebuild the village fully, but it's a start.",
                options: [{ text: "End the story.", next: "endGame_bittersweet" }]
            },
            fantasy_dragon_grab_large: {
                text: "You reach for the large chest. Ignis's eye snaps open, a single, fiery glare. It lets out a deafening roar, and a wave of fire engulfs you.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            fantasy_dragon_battle: {
                text: "You valiantly fight Ignis, but its scales deflect your blows, and its fire breath is overwhelming. You are no match for its raw power.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            fantasy_dragon_lair_weakness: {
                text: "You notice unstable volcanic vents near Ignis's resting spot. Perhaps you can trigger a collapse. But it's risky.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },

            // --- Fantasy Story: Journey to the Crystal Caves ---
            fantasy_crystal_caves_start: {
                title: "Fantasy: Journey to the Crystal Caves",
                text: "Legends speak of the Crystal Caves, hidden deep within the Whispering Mountains, where magical crystals grant wishes... or trap the unwary. You stand at the treacherous mountain pass.",
                options: [
                    { text: "Brave the treacherous mountain pass.", next: "fantasy_crystal_pass" },
                    { text: "Search for a hidden, safer entrance.", next: "fantasy_crystal_hidden_entrance" }
                ]
            },
            fantasy_crystal_pass: {
                text: "The path is narrow and icy. A sudden rockslide blocks your way! You are trapped.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            fantasy_crystal_hidden_entrance: {
                text: "You find a concealed cave entrance, shimmering with faint blue light. It leads into the heart of the Crystal Caves.",
                options: [
                    { text: "Enter the Crystal Caves.", next: "fantasy_crystal_inside" }
                ]
            },
            fantasy_crystal_inside: {
                text: "The caves glow with an otherworldly light, radiating from countless crystals. The air hums with magic. You see a large, pulsating central crystal.",
                options: [
                    { text: "Touch the central crystal.", next: "fantasy_crystal_touch" },
                    { text: "Look for the legendary 'Wish-Granting Crystal'.", next: "fantasy_crystal_wish" }
                ]
            },
            fantasy_crystal_touch: {
                text: "A surge of raw magic courses through you! You feel invigorated, but also disoriented. The cave shifts around you, and you're lost.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            fantasy_crystal_wish: {
                text: "You find a smaller, intricately carved crystal radiating pure, gentle light. This must be it! You can make one wish.",
                options: [
                    { text: "Wish for immense wealth.", next: "fantasy_crystal_wish_wealth" },
                    { text: "Wish for true knowledge.", next: "fantasy_crystal_wish_knowledge" },
                    { text: "Wish for safe passage home.", next: "fantasy_crystal_wish_home" }
                ]
            },
            fantasy_crystal_wish_wealth: {
                text: "Gold rains down around you! You are now incredibly rich, but the sudden influx of treasure collapses the cave entrance behind you. You are trapped with your new fortune.",
                options: [{ text: "End the story.", next: "endGame_bittersweet" }]
            },
            fantasy_crystal_wish_knowledge: {
                text: "All the knowledge of the universe floods your mind! You understand everything, but the sheer volume breaks your sanity. You are brilliant, but lost to the world.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            fantasy_crystal_wish_home: {
                text: "With a flash of light, you are safely transported back to your home, unharmed, with memories of your adventure. The crystal caves remain a secret.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },


            // --- Original Shared portal leading from woods_crystalcaverns etc. ---
            shared_portalchamber: {
                text: "The portal shimmers. You step through, feeling a strange disorientation. You emerge into a forgotten chamber, dimly lit by a single, glowing crystal. This crystal feels like the source of the temple's power. It could lead anywhere.",
                options: [
                    { text: "Try to attune to the crystal's power to pinpoint the relic.", next: "shared_crystalattune" },
                    { text: "Attempt to shatter the crystal, hoping to disrupt defenses.", next: "shared_crystalshatter" }
                ]
            },
            shared_crystalattune: {
                text: "You focus, reaching out to the crystal. Visions flood your mind: glimpses of the relic, and a direct path to its location, now clearly visible in your mind's eye. The chamber wall shimmers, revealing a new passage.",
                options: [
                    { text: "Enter the revealed passage.", next: "shared_finalpassage" }
                ]
            },
            shared_crystalshatter: {
                text: "You strike the crystal! It explodes with blinding light and searing heat. The chamber begins to collapse, and you are caught in the destructive blast.",
                options: [{ text: "End the story.", next: "endGame_magicdeath" }]
            },
            shared_finalpassage: {
                text: "The passage leads you directly to a hidden vault, untouched by time. The air hums with ancient power, and in the very center, bathed in a soft, ethereal glow, rests the Lost Relic!",
                options: [
                    { text: "Claim the Lost Relic.", next: "winGame_general" }
                ]
            },
            winGame_general: {
                text: "Congratulations! You have successfully retrieved the Lost Relic! Its ancient power hums within your grasp, ready for its next purpose. Your name will be etched into the annals of history!",
                options: []
            },

            // --- Win Story: The Grand Tournament ---
            win_tournament_start: {
                title: "Win: The Grand Tournament",
                text: "The King has announced the Grand Tournament! Champions from across the land gather to compete for glory, riches, and the hand of Princess Seraphina. You, a humble knight/warrior, arrive at the bustling tourney grounds.",
                options: [
                    { text: "Enter the jousting competition.", next: "win_tournament_joust" },
                    { text: "Enter the archery contest.", next: "win_tournament_archery" },
                    { text: "Enter the melee combat trial.", next: "win_tournament_melee" }
                ]
            },
            win_tournament_joust: {
                text: "The crowd roars as you mount your steed. Your first opponent is Sir Kael, a formidable champion. You charge, lance aimed true.",
                options: [
                    { text: "Aim for his shield, hoping to disarm.", next: "win_tournament_joust_hit" },
                    { text: "Aim for his helm, a risky but decisive blow.", next: "win_tournament_joust_critical" }
                ]
            },
            win_tournament_archery: {
                text: "The targets are set at various distances. The wind is a factor. You nock your first arrow.",
                options: [
                    { text: "Aim for the furthest, smallest target.", next: "win_tournament_archery_far" },
                    { text: "Take a safe, consistent shot.", next: "win_tournament_archery_safe" }
                ]
            },
            win_tournament_melee: {
                text: "You enter the arena, facing three skilled opponents in a free-for-all. Your weapon is drawn.",
                options: [
                    { text: "Engage the strongest opponent first.", next: "win_tournament_melee_strong" },
                    { text: "Use your agility to evade and pick off weaker foes.", next: "win_tournament_melee_agile" }
                ]
            },
            win_tournament_joust_hit: {
                text: "Your lance hits his shield squarely! He stumbles but remains mounted. The crowd groans. Your second pass awaits.",
                options: [
                    { text: "Charge again, with more force.", next: "win_tournament_joust_charge" }
                ]
            },
            win_tournament_joust_critical: {
                text: "A direct hit to his helm! Sir Kael is unseated in a spectacular crash! The crowd erupts. You win the joust!",
                options: [
                    { text: "Proceed to the next round of the tournament.", next: "win_tournament_final_round" }
                ]
            },
            win_tournament_archery_far: {
                text: "Your arrow flies true, hitting the center of the furthest target! A collective gasp from the crowd. You win the archery contest!",
                options: [
                    { text: "Proceed to the next round of the tournament.", next: "win_tournament_final_round" }
                ]
            },
            win_tournament_archery_safe: {
                text: "Your shot is good, but not enough to beat the top scores. You are eliminated from the archery contest.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            win_tournament_melee_strong: {
                text: "You boldly engage the largest opponent. Your duel is fierce, but his strength eventually overpowers you. You are defeated.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            win_tournament_melee_agile: {
                text: "You dart around, confusing your opponents. You disarm one, then another. The last foe surrenders. You win the melee trial!",
                options: [
                    { text: "Proceed to the next round of the tournament.", next: "win_tournament_final_round" }
                ]
            },
            win_tournament_joust_charge: {
                text: "You charge again, with overwhelming force. Sir Kael's lance splinters, and he is knocked from his horse! Victory is yours in the joust!",
                options: [
                    { text: "Proceed to the next round of the tournament.", next: "win_tournament_final_round" }
                ]
            },
            win_tournament_final_round: {
                text: "You stand as one of the final champions. Princess Seraphina watches from the royal box, her eyes fixed on you. The final challenge is a duel of honor against the King's most decorated champion, Sir Reginald.",
                options: [
                    { text: "Challenge Sir Reginald directly.", next: "win_tournament_duel_reginald" },
                    { text: "Try to gain an advantage through cunning.", next: "win_tournament_duel_cunning" }
                ]
            },
            win_tournament_duel_reginald: {
                text: "Sir Reginald is a master swordsman. The duel is long and arduous. You fight with all your might, and after a desperate final parry, you disarm him! The crowd erupts! You are the champion!",
                options: [{ text: "End the story.", next: "winGame_tournament_champion" }]
            },
            win_tournament_duel_cunning: {
                text: "You attempt to feign weakness, leading Sir Reginald into a trap. He is too experienced and sees through your ruse, delivering a swift, decisive blow that defeats you.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            winGame_tournament_champion: {
                text: "You are crowned the champion of the Grand Tournament! Princess Seraphina smiles, and the King grants you riches and honor. Your name will be remembered for generations as a true hero!",
                options: []
            },

            // --- Visit Story: The Floating City of Aeridor ---
            visit_aeridor_start: {
                title: "Visit: The Floating City of Aeridor",
                text: "You've acquired passage on a sky-skiff to Aeridor, the legendary city that floats among the clouds. As you approach, colossal airships glide around crystalline towers, a truly breathtaking sight.",
                options: [
                    { text: "Disembark at the Grand Skyport.", next: "visit_aeridor_skyport" },
                    { text: "Arrange for a private tour of the lower districts.", next: "visit_aeridor_lower_districts" }
                ]
            },
            visit_aeridor_skyport: {
                text: "The Grand Skyport is a bustling hub of activity. Merchants hawk exotic goods, inventors tinker with strange contraptions, and sky-sailors share tales. The air is filled with the scent of ozone and spiced tea.",
                options: [
                    { text: "Explore the Grand Market.", next: "visit_aeridor_market" },
                    { text: "Seek out the famous Aeridorian Observatory.", next: "visit_aeridor_observatory" }
                ]
            },
            visit_aeridor_lower_districts: {
                text: "The lower districts are grittier, but alive with a different energy. Workshops hum, steam vents hiss, and the working class of Aeridor live their lives. You hear whispers of forbidden, ancient tech.",
                options: [
                    { text: "Investigate the whispers of forbidden tech.", next: "visit_aeridor_tech_whispers" },
                    { text: "Find a local eatery for a taste of authentic Aeridorian cuisine.", next: "visit_aeridor_eatery" }
                ]
            },
            visit_aeridor_market: {
                text: "The Grand Market is a sensory overload! You see anti-gravity fruit, clockwork pets, and scrolls of forgotten lore. A charming merchant tries to sell you a 'genuine cloud-in-a-bottle.'",
                options: [
                    { text: "Buy the cloud-in-a-bottle (just for fun).", next: "visit_aeridor_buy_cloud" },
                    { text: "Bargain for a map of Aeridor's hidden levels.", next: "visit_aeridor_map" }
                ]
            },
            visit_aeridor_observatory: {
                text: "The observatory offers unparalleled views of the cloud ocean below and the stars above. The chief astronomer, a kindly old woman, is studying strange energy readings from the cloud layer.",
                options: [
                    { text: "Ask about the energy readings.", next: "visit_aeridor_energy_readings" },
                    { text: "Enjoy the breathtaking view.", next: "winGame_general" }
                ]
            },
            visit_aeridor_tech_whispers: {
                text: "You follow leads to a clandestine workshop. A shadowy figure offers you a stolen prototype 'gravity disrupter,' capable of manipulating Aeridor's stability, for a high price.",
                options: [
                    { text: "Acquire the gravity disrupter.", next: "visit_aeridor_acquire_disrupter" },
                    { text: "Report the workshop to Aeridorian authorities.", next: "visit_aeridor_report_workshop" }
                ]
            },
            visit_aeridor_eatery: {
                text: "You enjoy a delicious meal of 'sky-fish' and 'storm-root' stew. The proprietor tells you local tales of Aeridor's ancient sky-whales that live beneath the clouds.",
                options: [
                    { text: "Ask more about sky-whales.", next: "visit_aeridor_sky_whales" },
                    { text: "Enjoy the meal and atmosphere.", next: "winGame_general" }
                ]
            },
            visit_aeridor_buy_cloud: {
                text: "The cloud-in-a-bottle fizzes slightly. It does nothing, but you have a charming souvenir. Your visit continues.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            visit_aeridor_map: {
                text: "After some shrewd bargaining, you get a map detailing secret passages and forgotten sections of the city. One section is marked 'The Cloud Nursery.'",
                options: [
                    { text: "Seek out 'The Cloud Nursery'.", next: "visit_aeridor_cloud_nursery" }
                ]
            },
            visit_aeridor_energy_readings: {
                text: "The astronomer explains that the energy readings are increasing, indicating a massive, ancient sky-whale is approaching Aeridor, drawn by its energy. It could collide with the city!",
                options: [
                    { text: "Warn the Aeridorian council.", next: "visit_aeridor_warn_council" },
                    { text: "Try to find a way to redirect the whale.", next: "visit_aeridor_redirect_whale" }
                ]
            },
            visit_aeridor_acquire_disrupter: {
                text: "You acquire the gravity disrupter. It hums ominously. You now possess the power to move or destabilize entire sections of the city. What will you do with such power?",
                options: [
                    { text: "Use it to secure a personal fortune.", next: "endGame_failure" },
                    { text: "Use it to help the city (e.g., redirect the sky-whale).", next: "visit_aeridor_redirect_whale" }
                ]
            },
            visit_aeridor_report_workshop: {
                text: "You report the illicit workshop. Authorities raid it, preventing a potential disaster. You are thanked for your vigilance. Your visit concludes on a positive note.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            visit_aeridor_sky_whales: {
                text: "The proprietor describes the sky-whales as gentle, colossal creatures, living in the depths of the cloud ocean, rarely seen. He speaks of ancient songs that can guide them.",
                options: [
                    { text: "Try to find information on the ancient songs.", next: "visit_aeridor_ancient_songs" }
                ]
            },
            visit_aeridor_cloud_nursery: {
                text: "Following the map, you find a vast, hidden cavern within the city's underside. It's a nursery for baby sky-whales! They float gently, feeding on cloud wisps. A sight of pure wonder.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            visit_aeridor_warn_council: {
                text: "The council is initially skeptical, but your evidence from the observatory is convincing. They initiate emergency maneuvers, narrowly avoiding collision with the massive sky-whale. Aeridor is safe!",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            visit_aeridor_redirect_whale: {
                text: "Using knowledge from the observatory or the disrupter, you find a way to broadcast a low-frequency sonic pulse. The sky-whale, startled but unharmed, changes course, drifting away from Aeridor. The city is safe!",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            visit_aeridor_ancient_songs: {
                text: "You search the city's archives for ancient songs. You find fragmented melodies. Perhaps you can piece them together to guide the sky-whales (potentially linking to redirect_whale).",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },

            // --- Spider-Man Story: Spider-Man: Web of Decisions ---
            spiderman_start: {
                title: "Spider-Man: Web of Decisions",
                text: "As Spider-Man, you're swinging through Midtown, enjoying a quiet night... until a frantic police siren rips through the air. A bank robbery is in progress!",
                options: [
                    { text: "Head straight to the bank, confronting the robbers directly.", next: "spiderman_bank_direct" },
                    { text: "Swing to a vantage point, assess the situation first.", next: "spiderman_bank_vantage" }
                ]
            },
            spiderman_bank_direct: {
                text: "You burst through the skylight! A gang of armed thugs led by Shocker are scooping cash. 'Alright, fellas, put your hands up... or I'll put my feet down!'",
                options: [
                    { text: "Engage Shocker first, aiming to disable his gauntlets.", next: "spiderman_fight_shocker" },
                    { text: "Disarm the lesser thugs quickly, then deal with Shocker.", next: "spiderman_disarm_thugs" }
                ]
            },
            spiderman_bank_vantage: {
                text: "From a rooftop, you see Shocker and his crew inside. There's a civilian hostage! Shocker threatens to use his vibro-shock gauntlets. A news helicopter hovers nearby, spotlighting the scene.",
                options: [
                    { text: "Infiltrate quietly, prioritize rescuing the hostage.", next: "spiderman_infiltrate_hostage" },
                    { text: "Create a loud distraction to draw Shocker's attention.", next: "spiderman_distraction" }
                ]
            },
            spiderman_fight_shocker: {
                text: "You web-sling past the thugs, hitting Shocker with a powerful kick. His gauntlets spark, but he retaliates with a seismic blast, sending you flying into a wall!",
                options: [
                    { text: "Shake it off, hit him with a rapid web shot.", next: "spiderman_web_shocker" },
                    { text: "Dodge and look for an environmental weakness.", next: "spiderman_env_weakness" }
                ]
            },
            spiderman_disarm_thugs: {
                text: "You web up the thugs' weapons, then stick them to the ceiling. Shocker growls, 'You pest! This is personal now!' He unleashes a barrage of sonic blasts.",
                options: [
                    { text: "Evade his blasts, getting close for a melee attack.", next: "spiderman_evade_melee" },
                    { text: "Use the bank's structure as cover, drawing him out.", next: "spiderman_bank_cover" }
                ]
            },
            spiderman_infiltrate_hostage: {
                text: "You silently enter through a ventilation shaft. The hostage is tied to a pillar. You carefully web their restraints, but the hostage screams when they see you!",
                options: [
                    { text: "Silence the hostage gently, explaining you're here to help.", next: "spiderman_silence_hostage" },
                    { text: "Immediately grab the hostage and make a break for it.", next: "spiderman_grab_hostage" }
                ]
            },
            spiderman_distraction: {
                text: "You smash a nearby window, creating a loud crash! Shocker turns, giving you an opening. You rappel down, but the civilian hostage sees you and panics.",
                options: [
                    { text: "Prioritize the civilian, even if it means losing Shocker temporarily.", next: "spiderman_priority_civilian" },
                    { text: "Engage Shocker, knowing the civilian is still exposed.", next: "spiderman_engage_shocker_exposed" }
                ]
            },
            spiderman_web_shocker: {
                text: "Your web streams hit Shocker, temporarily blinding him and jamming his gauntlets. He stumbles, giving you an opening. You quickly web him to a vault door. Mission accomplished.",
                options: [
                    { text: "Secure the scene and wait for police.", next: "winGame_spiderman_clean" }
                ]
            },
            spiderman_env_weakness: {
                text: "You notice a large, unstable stack of money carts. You web-pull one into Shocker's path. He blasts it, causing a chaotic explosion of cash that buys you time. You then web him.",
                options: [
                    { text: "Secure Shocker and wait for police amidst flying cash.", next: "winGame_spiderman_messy" }
                ]
            },
            spiderman_evade_melee: {
                text: "You're a blur of red and blue, dodging every blast. You land a flurry of punches, forcing Shocker back. He tries to retaliate, but you web up his gauntlets and stick him to the ceiling.",
                options: [
                    { text: "Secure the scene and wait for police.", next: "winGame_spiderman_clean" }
                ]
            },
            spiderman_bank_cover: {
                text: "You use the sturdy teller counters as cover, drawing Shocker's blasts. He eventually damages a support beam, bringing down debris. You take an opportunity to web him as he's distracted.",
                options: [
                    { text: "Secure Shocker and wait for police amidst the damaged bank.", next: "winGame_spiderman_damaged" }
                ]
            },
            spiderman_silence_hostage: {
                text: "You put a web-glove over her mouth, whispering, 'Shhh, I'm Spider-Man. I'm getting you out.' She calms down. You then web her to your back and burst out, surprising Shocker. He fires a blast!",
                options: [
                    { text: "Evade the blast, protecting the hostage.", next: "spiderman_evade_protect" },
                    { text: "Use the hostage as a human shield (unthinkable!).", next: "endGame_spiderman_villain" }
                ]
            },
            spiderman_grab_hostage: {
                text: "You snatch the hostage and immediately try to escape. The hostage screams, panicking, making it hard to swing! Shocker hears and blasts a wall, creating rubble that blocks your exit.",
                options: [
                    { text: "Try to clear the rubble while holding the hostage.", next: "spiderman_clear_rubble" },
                    { text: "Drop the hostage and engage Shocker.", next: "spiderman_drop_hostage" }
                ]
            },
            spiderman_priority_civilian: {
                text: "You swing to the civilian, quickly webbing her away from Shocker. He's enraged by your focus on the innocent. The news helicopter captures your heroic rescue.",
                options: [
                    { text: "Now engage Shocker, with the civilian safe.", next: "spiderman_engage_shocker_safe" },
                    { text: "Leave Shocker for the police, focus on getting the civilian out.", next: "spiderman_leave_shocker" }
                ]
            },
            spiderman_engage_shocker_exposed: {
                text: "You leap at Shocker, but your focus is split between him and the panicking civilian. Shocker takes advantage, hitting you with a powerful blast that sends you flying through the window. The civilian is now even more exposed.",
                options: [{ text: "End the story.", next: "endGame_spiderman_fail" }]
            },
            spiderman_evade_protect: {
                text: "You twist and flip, using your spider-sense. The blast hits the wall behind you. You land outside, safe, with the grateful hostage. Shocker is still inside.",
                options: [
                    { text: "Return to apprehend Shocker.", next: "spiderman_return_apprehend" },
                    { text: "Leave him for the police, ensuring the civilian's safety first.", next: "spiderman_leave_shocker" }
                ]
            },
            spiderman_clear_rubble: {
                text: "You struggle, trying to clear the path, but the hostage's fear makes her squirm. Shocker closes in, ready to finish you. You are caught in his final, devastating blast.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            spiderman_drop_hostage: {
                text: "You reluctantly drop the screaming hostage to engage Shocker. He's furious. While you fight, the hostage manages to free herself and runs out into the street, directly into the path of a speeding car!",
                options: [{ text: "End the story.", next: "endGame_spiderman_civilian_death" }]
            },
            spiderman_engage_shocker_safe: {
                text: "With the civilian safe, your focus is absolute. You easily outmaneuver Shocker, webbing him to the ground. The news helicopter captures your decisive victory.",
                options: [
                    { text: "Await police, basking in public admiration.", next: "winGame_spiderman_hero" }
                ]
            },
            spiderman_leave_shocker: {
                text: "You get the civilian safely away, leaving Shocker for the arriving police. J. Jonah Jameson immediately blasts you on the Daily Bugle, claiming you're a coward who fled.",
                options: [
                    { text: "Accept the public criticism, knowing you did the right thing.", next: "endGame_spiderman_criticism" }
                ]
            },
            spiderman_return_apprehend: {
                text: "You return to the bank, Shocker is still rampaging. You quickly subdue him, webbing him securely. The police arrive to take him away. You saved the day!",
                options: [
                    { text: "Swing away into the night, a silent hero.", next: "winGame_spiderman_clean" }
                ]
            },
            winGame_spiderman_clean: {
                text: "You swiftly apprehended the villain, protected the innocent, and vanished without a trace. Another day, another city saved. You are Spider-Man, the friendly neighborhood hero!",
                options: []
            },
            winGame_spiderman_messy: {
                text: "Shocker is captured, but the bank is a mess of scattered cash. While effective, your method was... unorthodox. J. Jonah Jameson will have a field day, but the city is safe!",
                options: []
            },
            winGame_spiderman_damaged: {
                text: "Shocker is apprehended, but the bank sustained significant damage. The police chief gives you a stern look. You saved the money, but at what cost? Still, the city is safe.",
                options: []
            },
            winGame_spiderman_hero: {
                text: "Your heroism was undeniable. The news praises Spider-Man! Even J. Jonah Jameson has to begrudgingly admit you did some good. You feel a rare sense of public appreciation.",
                options: []
            },
            endGame_spiderman_villain: {
                text: "You... you used the hostage as a shield?! The thought alone sickens you. Your moral compass shatters. This isn't what Spider-Man does. You lose yourself in despair, your heroism forever tainted.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            endGame_spiderman_fail: {
                text: "Your attempt to balance objectives failed, putting an innocent life at risk. Shocker escapes, and the civilian is traumatized. You failed them both, a heavy burden for a hero.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            endGame_spiderman_civilian_death: {
                text: "You chose to engage the villain over protecting the innocent. The civilian, left vulnerable, was hit by a speeding car. You apprehend Shocker, but the cost is unbearable. A life lost. Your guilt is eternal.",
                options: [{ text: "End the story.", next: "endGame_tragic_love" }] // Reusing tragic love for devastating personal failure
            },
            endGame_spiderman_criticism: {
                text: "You saved the civilian's life, but J. Jonah Jameson's relentless campaign paints you as a coward. The city's trust in Spider-Man wavers. You wonder if your sacrifices are truly worth it.",
                options: [{ text: "End the story.", next: "endGame_bittersweet" }]
            },

            // --- Avengers Story: Avengers: Global Threat Protocol ---
            avengers_start: {
                title: "Avengers: Global Threat Protocol",
                text: "The Helicarrier's alarms blare. Director Fury's voice echoes: 'Avengers! We have a global threat! A Kree Sentry has landed in downtown Tokyo and is causing widespread destruction.'",
                options: [
                    { text: "Assemble the full team and deploy to Tokyo.", next: "avengers_deploy_full" },
                    { text: "Send a smaller strike team to assess and contain.", next: "avengers_deploy_strike" }
                ]
            },
            avengers_deploy_full: {
                text: "Iron Man, Captain America, Thor, Hulk, Black Widow, and Hawkeye deploy. The Sentry is indeed massive, firing energy blasts. Casualties are mounting. Civilians are trapped.",
                options: [
                    { text: "Focus all firepower on disabling the Sentry.", next: "avengers_focus_sentry" },
                    { text: "Prioritize civilian evacuation, then attack the Sentry.", next: "avengers_evac_first" }
                ]
            },
            avengers_deploy_strike: {
                text: "Captain America, Black Widow, and Hawkeye deploy. The Sentry is more powerful than anticipated, quickly overwhelming the smaller team. Cap orders a retreat, but it's too late.",
                options: [{ text: "End the story.", next: "endGame_combatdeath" }]
            },
            avengers_focus_sentry: {
                text: "The Avengers unleash their full might. Hulk smashes, Thor calls lightning, Iron Man fires repulsors. The Sentry is heavily damaged, but its retaliatory blasts cause immense collateral damage. Many civilians are caught in the crossfire.",
                options: [
                    { text: "Disable the Sentry at all costs.", next: "avengers_disable_sentry_cost" },
                    { text: "Shift focus to civilian protection, even if it delays the Sentry's defeat.", next: "avengers_shift_focus" }
                ]
            },
            avengers_evac_first: {
                text: "Captain America coordinates a rapid civilian evacuation, with Black Widow and Hawkeye providing cover. Iron Man and Thor distract the Sentry. Lives are saved, but the Sentry continues its rampage, causing more damage.",
                options: [
                    { text: "Now engage the Sentry with full force.", next: "avengers_engage_sentry_now" },
                    { text: "Seek a strategic weakness while continuing limited evacuation.", next: "avengers_strategic_weakness" }
                ]
            },
            avengers_disable_sentry_cost: {
                text: "With a final, concentrated blast, the Sentry is destroyed! Cheers erupt, but the city is devastated. Fury reprimands the team for the excessive collateral damage. You saved the world, but at a high cost.",
                options: [{ text: "End the story.", next: "winGame_avengers_pyrrhic" }]
            },
            avengers_shift_focus: {
                text: "Hulk and Thor redirect their attacks to create barriers, while Iron Man and the others guide civilians to safety. The Sentry remains a threat, but civilian casualties drop significantly.",
                options: [
                    { text: "Re-engage the Sentry, now with fewer civilian risks.", next: "avengers_engage_sentry_now" }
                ]
            },
            avengers_engage_sentry_now: {
                text: "With civilians cleared, the Avengers attack with ruthless efficiency. The Sentry, no longer able to use civilians as shields, is quickly overwhelmed and destroyed.",
                options: [
                    { text: "Tokyo is safe, and the Avengers are hailed as heroes.", next: "winGame_avengers_heroic" }
                ]
            },
            avengers_strategic_weakness: {
                text: "Tony Stark analyzes the Sentry's energy signature, finding a weak point in its power core. Hawkeye aims a precise arrow, disrupting its shields. Hulk then delivers a critical blow.",
                options: [
                    { text: "Disable the Sentry with minimal damage.", next: "winGame_avengers_strategic" }
                ]
            },
            winGame_avengers_heroic: {
                text: "Tokyo is saved, and the Avengers are celebrated globally. Your teamwork and commitment to civilian safety solidified your status as Earth's mightiest heroes!",
                options: []
            },
            winGame_avengers_pyrrhic: {
                text: "The Sentry is destroyed, but Tokyo is a ruin. The world is safe, but questions are raised about the Avengers' methods. A victory, but with a heavy heart.",
                options: []
            },
            winGame_avengers_strategic: {
                text: "The Sentry is disabled with precision, minimizing damage and casualties. Director Fury offers a rare smile. Your strategic thinking and teamwork saved the day efficiently and heroically.",
                options: []
            },

            // --- Superhero Story: The Phantom Thief of Gotham ---
            superhero_phantom_start: {
                title: "Superhero: The Phantom Thief of Gotham",
                text: "As Gotham's vigilante, you receive a tip: the elusive 'Phantom Thief' plans to steal the priceless Star of Gotham diamond from Wayne Gala tonight. Do you confront them directly, or stake out the gala?",
                options: [
                    { text: "Head directly to the gala to confront the thief.", next: "superhero_phantom_gala_confront" },
                    { text: "Set up surveillance near the gala's entry points.", next: "superhero_phantom_gala_stakeout" }
                ]
            },
            superhero_phantom_gala_confront: {
                text: "You arrive just as the Phantom Thief makes their move! They're agile, slipping past guards. You leap into action.",
                options: [
                    { text: "Engage the thief in a direct fight.", next: "superhero_phantom_fight" },
                    { text: "Try to trap the thief with a gadget.", next: "superhero_phantom_trap" }
                ]
            },
            superhero_phantom_gala_stakeout: {
                text: "From your vantage, you see the Phantom Thief, disguised as a waiter, slip past security. They move with unnatural grace. You need to follow without blowing your cover.",
                options: [
                    { text: "Shadow the thief through the crowd.", next: "superhero_phantom_shadow" },
                    { text: "Alert the police to their presence.", next: "superhero_phantom_alert_police" }
                ]
            },
            superhero_phantom_fight: {
                text: "The Phantom Thief is surprisingly skilled in combat, matching your every move. They use acrobatics to evade your attacks, eventually vanishing into the shadows with the diamond.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },
            superhero_phantom_trap: {
                text: "You deploy a silent net gadget, catching the thief mid-leap! The diamond clatters to the ground. You have caught the Phantom Thief!",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            superhero_phantom_shadow: {
                text: "You follow them discreetly. They lead you to a hidden vault entrance. They're not just stealing the diamond; they're after something inside the vault.",
                options: [{ text: "End the story.", next: "winGame_general" }]
            },
            superhero_phantom_alert_police: {
                text: "You alert the police. They swarm the gala, but the Phantom Thief, sensing the increased presence, slips away into the chaos, diamond in hand.",
                options: [{ text: "End the story.", next: "endGame_failure" }]
            },


            // --- Original Generic Endings (shared across all stories) ---
            endGame_failure: {
                text: "Your adventure ends here. You were unable to overcome the challenges, and the quest remains unfinished. Perhaps another time, another hero.",
                options: []
            },
            endGame_combatdeath: {
                text: "You fought bravely, but the odds were stacked against you. Your journey ends in a valiant but futile struggle. The forces of evil (or nature) prevail.",
                options: []
            },
            endGame_magicdeath: {
                text: "The ancient magic/technology proved too much. You were consumed by arcane/alien forces, your quest ending in a flash of light and a whisper of despair. The secrets remain.",
                options: []
            },
            endGame_bittersweet: {
                text: "A bittersweet ending. You achieved a form of success, but at a significant personal cost or with lingering unresolved issues. Life goes on, but it's not quite the fairytale you hoped for.",
                options: []
            },
            // Specific endings for love stories
            endGame_failure_love: {
                text: "Your love story takes a tragic turn. Circumstances, war, or difficult choices ultimately separate you. Your quest for love ends in heartbreak and failure.",
                options: []
            },
            endGame_tragic_love: {
                text: "A truly heartbreaking end. Your love, though pure, was not strong enough to overcome the forces arrayed against it. You are left with only memories and regret.",
                options: []
            },
            endGame_bittersweet_love: {
                text: "Victory was achieved, but at a personal cost. Your love story, in its original form, could not endure. You live with the consequences of your choices, finding a different kind of peace, but always with a lingering shadow of what was lost.",
                options: []
            }
        };

        // Current state variables
        let currentStoryId = 'storySelection'; // Points to the current main story's top-level key in `allStories`
        let currentSceneKey = 'storySelection'; // Points to the current node key within the active story

        // DOM elements
        const mainTitleElement = document.getElementById('mainTitle');
        const storyTextElement = document.getElementById('storyText');
        const optionsContainer = document.getElementById('optionsContainer');
        const restartButton = document.getElementById('restartButton');
        const storySearchInput = document.getElementById('storySearch');
        const searchContainer = document.getElementById('searchContainer');

        // Function to display the story selection screen with optional filtering
        function displayStorySelection(filterText = '') {
            mainTitleElement.textContent = allStories.storySelection.title;
            storyTextElement.textContent = allStories.storySelection.text;
            optionsContainer.innerHTML = '';
            searchContainer.classList.remove('hidden'); // Show search bar on selection screen
            storySearchInput.value = filterText; // Keep filter text in input

            const lowerCaseFilter = filterText.toLowerCase();

            // Filter options based on search input
            allStories.storySelection.options.forEach(option => {
                if (option.text.toLowerCase().includes(lowerCaseFilter)) {
                    const button = document.createElement('button');
                    button.classList.add('option-button', 'story-select-button');
                    button.textContent = option.text;
                    button.addEventListener('click', () => {
                        // Check if this is one of the custom name input stories
                        if (option.next.includes('_input_names')) { // Check for custom name input pattern
                            displayCustomNameInput(option.next); // Go to name input screen
                        } else {
                            currentStoryId = option.next; // Store which main story is active
                            currentSceneKey = option.next; // Set starting node for chosen story
                            searchContainer.classList.add('hidden'); // Hide search bar during game
                            showScene(currentSceneKey);
                        }
                    });
                    optionsContainer.appendChild(button);
                }
            });
            restartButton.classList.add('hidden'); // Hide restart button on selection screen
        }

        // Function to display custom name input form
        function displayCustomNameInput(storyInputKey) {
            const storyDetails = allStories[storyInputKey];
            mainTitleElement.textContent = storyDetails.title;
            storyTextElement.textContent = storyDetails.text;
            optionsContainer.innerHTML = '';
            searchContainer.classList.add('hidden'); // Hide search bar

            let inputFormHtml = `
                <div class="name-input-group">
                    <label for="heroNameInput">Your Name (Hero):</label>
                    <input type="text" id="heroNameInput" value="${heroName}" placeholder="e.g., Arthur">
                    <label for="heroineNameInput">Their Name (Heroine):</label>
                    <input type="text" id="heroineNameInput" value="${heroineName}" placeholder="e.g., Guinevere">
            `;

            // Conditionally add coaching center input for specific story
            if (storyInputKey === 'customlove5_input_names') {
                inputFormHtml += `
                    <label for="coachingCenterNameInput">Coaching Center/Institution Name:</label>
                    <input type="text" id="coachingCenterNameInput" value="${coachingCenterName}" placeholder="e.g., Elite Coaching Center">
                `;
            }

            inputFormHtml += `
                    <button id="startCustomStoryBtn" class="start-story-button">Start Story</button>
                </div>
            `;
            optionsContainer.innerHTML = inputFormHtml;
            restartButton.classList.remove('hidden'); // Allow returning to selection

            document.getElementById('startCustomStoryBtn').addEventListener('click', () => {
                heroName = document.getElementById('heroNameInput').value.trim() || "Hero";
                heroineName = document.getElementById('heroineNameInput').value.trim() || "Heroine";

                if (storyInputKey === 'customlove5_input_names') {
                    coachingCenterName = document.getElementById('coachingCenterNameInput').value.trim() || "Elite Coaching Center";
                }


                // Transition to the actual first node of the chosen custom story
                // Logic to map from input_names key to true_start key
                const actualStartNodeKey = storyInputKey.replace('_input_names', '_true_start');
                if (allStories[actualStartNodeKey]) {
                    currentStoryId = actualStartNodeKey;
                    currentSceneKey = actualStartNodeKey;
                    showScene(currentSceneKey);
                } else {
                    // Fallback if true_start is not defined (shouldn't happen with correct mapping)
                    console.error("No true_start node found for:", storyInputKey);
                    storyTextElement.textContent = "Error starting story. Returning to selection.";
                    displayStorySelection();
                }
            });
        }

        // Function to process text with dynamic names
        function processText(text) {
            // Ensure text is a string before calling replace
            if (typeof text !== 'string') {
                console.warn("processText received non-string input:", text);
                return String(text || ''); // Convert to string, default to empty if null/undefined
            }
            return text
                .replace(/{heroName}/g, heroName)
                .replace(/{heroineName}/g, heroineName)
                .replace(/{coachingCenterName}/g, coachingCenterName); // Add new replacement
        }

        // Function to display a scene within an active story
        function showScene(sceneKey) {
            const scene = allStories[sceneKey];

            if (!scene) {
                storyTextElement.textContent = "An error occurred: This part of the story seems to be missing. Returning to story selection.";
                // Go back to story selection if a scene is not found
                currentStoryId = 'storySelection';
                currentSceneKey = 'storySelection';
                displayStorySelection();
                return;
            }

            // Update main title
            if (scene.title) {
                mainTitleElement.textContent = scene.title;
            } else if (currentStoryId !== 'storySelection' && allStories[currentStoryId] && allStories[currentStoryId].title) {
                // If we are in an active story, keep its title
                mainTitleElement.textContent = allStories[currentStoryId].title;
            } else {
                mainTitleElement.textContent = "Your Adventure"; // Fallback title
            }

            storyTextElement.textContent = processText(scene.text); // Process text for names
            optionsContainer.innerHTML = ''; // Clear previous options

            // Create buttons for each option
            if (scene.options && scene.options.length > 0) {
                scene.options.forEach(option => {
                    const button = document.createElement('button');
                    button.classList.add('option-button');
                    // Ensure option.text exists before processing
                    button.textContent = processText(option.text || ''); // Process option text for names
                    button.addEventListener('click', () => {
                        currentSceneKey = option.next; // Move to the next node in current story
                        showScene(currentSceneKey);
                    });
                    optionsContainer.appendChild(button);
                });
                restartButton.classList.add('hidden'); // Hide restart button during active play
                searchContainer.classList.add('hidden'); // Ensure search bar is hidden during play
            } else {
                // If no options, it's an end state
                restartButton.classList.remove('hidden'); // Show restart button
                searchContainer.classList.add('hidden'); // Ensure search bar is hidden on end screen
            }
        }

        // Event listener for restart button - now returns to story selection
        restartButton.addEventListener('click', () => {
            currentStoryId = 'storySelection';
            currentSceneKey = 'storySelection';
            displayStorySelection(); // Call the function to display selection
        });

        // Event listener for search input
        storySearchInput.addEventListener('keyup', (e) => {
            displayStorySelection(e.target.value);
        });

        // Initialize the game when the window loads
        window.onload = function() {
            displayStorySelection(); // Start at the story selection screen
        };
    </script>
</body>
</html>