<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cookie Clicker Master</title> <!-- Updated Title -->
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="shared.css">
    <script src="shared.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');

        body {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #050814 0%, #0a0a16 100%);
            font-family: 'Inter', sans-serif;
            color: #fff;
            user-select: none;
            position: relative;
        }

        #game-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding: 40px;
            border-radius: 1.5rem;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid rgba(0, 234, 255, 0.2);
            box-shadow: 0 0 30px rgba(0, 234, 255, 0.1);
            backdrop-filter: blur(10px);
            width: 90%;
            max-width: 450px;
            box-sizing: border-box;
            position: relative;
            z-index: 1;
            margin-top: 20px;
            margin-bottom: 20px;
        }

        h1 {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(to right, #00eaff, #ff0055);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            text-shadow: 0 0 10px rgba(0, 234, 255, 0.3);
            text-align: center;
            font-size: 1.5rem;
            margin-bottom: 20px;
            line-height: 1.4;
        }

        #cookie {
            width: 250px;
            height: 250px;
            background-color: transparent;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: transform 0.1s ease-out, filter 0.2s ease;
            position: relative;
            z-index: 10;
        }

        #cookie:active {
            transform: scale(0.9);
            filter: brightness(1.2);
        }

        #cookie svg {
            width: 100%;
            height: 100%;
            display: block;
            filter: drop-shadow(0 0 20px rgba(0, 234, 255, 0.6));
        }

        #score {
            margin-top: 25px;
            font-family: 'Press Start 2P', cursive;
            font-size: 2rem;
            color: #00eaff;
            text-shadow: 0 0 15px rgba(0, 234, 255, 0.5);
            text-align: center;
        }

        #cps-display {
            font-size: 1rem;
            font-family: 'Press Start 2P', cursive;
            color: #ff0055;
            margin-top: 10px;
            text-shadow: 0 0 10px rgba(255, 0, 85, 0.5);
        }

        .floating-score {
            position: absolute;
            color: #00ff41;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            text-shadow: 0 0 10px rgba(0, 255, 65, 0.8);
            animation: fadeOutUp 1s forwards;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes fadeOutUp {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }

            100% {
                opacity: 0;
                transform: translateY(-80px) scale(1.5);
            }
        }

        .upgrades-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
            width: 100%;
            max-width: 350px;
        }

        .upgrades-container h2 {
            font-family: 'Press Start 2P', cursive;
            font-size: 1.2rem;
            color: #fff;
            text-align: center;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        .upgrade-button {
            padding: 15px 20px;
            background: rgba(0, 234, 255, 0.05);
            color: #00eaff;
            border: 1px solid rgba(0, 234, 255, 0.4);
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 0 10px rgba(0, 234, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-family: 'Inter', sans-serif;
        }

        .upgrade-button:hover:not(:disabled) {
            background: rgba(0, 234, 255, 0.2);
            box-shadow: 0 0 20px rgba(0, 234, 255, 0.4);
            transform: translateX(5px);
        }

        .upgrade-button:active:not(:disabled) {
            transform: translateX(2px);
            box-shadow: 0 0 5px rgba(0, 234, 255, 0.2);
        }

        .upgrade-button:disabled {
            background: rgba(15, 23, 42, 0.8);
            color: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.1);
            cursor: not-allowed;
            box-shadow: none;
        }

        .upgrade-cost {
            font-size: 0.9em;
            color: #ff0055;
            font-family: 'Press Start 2P', cursive;
            font-size: 0.7rem;
            text-shadow: 0 0 5px rgba(255, 0, 85, 0.5);
        }

        .upgrade-button:disabled .upgrade-cost {
            color: rgba(255, 255, 255, 0.3);
            text-shadow: none;
        }

        #resetButton {
            margin-top: 30px;
            padding: 12px 25px;
            background: rgba(255, 0, 85, 0.1);
            color: #ff0055;
            border: 1px solid rgba(255, 0, 85, 0.5);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 0 10px rgba(255, 0, 85, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 350px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1rem;
        }

        #resetButton:hover {
            background: rgba(255, 0, 85, 0.3);
            box-shadow: 0 0 20px rgba(255, 0, 85, 0.4);
            transform: translateY(-2px);
        }

        #resetButton:active {
            transform: translateY(2px);
            box-shadow: 0 0 5px rgba(255, 0, 85, 0.2);
        }
    </style>
</head>

<body>
    <div id="game-area">
        <h1>Cookie Clicker Master</h1> <!-- Game Title -->
        <div id="cookie">
            <!-- SVG Cookie Illustration -->
            <svg viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                <!-- Cookie base -->
                <circle cx="100" cy="100" r="90" fill="#e0b080" />
                <!-- Inner shadow for depth -->
                <circle cx="100" cy="100" r="90" fill="url(#shadowGradient)" />
                <defs>
                    <radialGradient id="shadowGradient" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse"
                        gradientTransform="translate(100 100) rotate(90) scale(180)">
                        <stop offset="0.5" stop-color="#000000" stop-opacity="0" />
                        <stop offset="1" stop-color="#000000" stop-opacity="0.2" />
                    </radialGradient>
                </defs>

                <!-- Chocolate Chips -->
                <circle cx="55" cy="45" r="15" fill="#4a2b1f" />
                <circle cx="130" cy="60" r="12" fill="#4a2b1f" />
                <circle cx="80" cy="120" r="18" fill="#4a2b1f" />
                <circle cx="150" cy="130" r="10" fill="#4a2b1f" />
                <circle cx="60" cy="160" r="14" fill="#4a2b1f" />
                <circle cx="110" cy="70" r="10" fill="#4a2b1f" />
                <circle cx="140" cy="90" r="16" fill="#4a2b1f" />
            </svg>
        </div>
        <div id="score">0 Cookies</div>
        <div id="cps-display">0 Cookies/sec</div>

        <div class="upgrades-container">
            <h2>Upgrades</h2>
            <button id="autoClickerButton" class="upgrade-button">
                <span>Cursor (<span id="autoClickerCount">0</span>)</span>
                <span class="upgrade-cost">Cost: <span id="autoClickerCost">10</span></span>
            </button>
            <button id="grandmaButton" class="upgrade-button">
                <span>Grandma (<span id="grandmaCount">0</span>)</span>
                <span class="upgrade-cost">Cost: <span id="grandmaCost">100</span></span>
            </button>
            <!-- New Upgrade: Oven -->
            <button id="ovenButton" class="upgrade-button">
                <span>Oven (<span id="ovenCount">0</span>)</span>
                <span class="upgrade-cost">Cost: <span id="ovenCost">500</span></span>
            </button>
        </div>

        <!-- Reset Button Added -->
        <button id="resetButton">Reset Game</button>
    </div>

    <script>
        // Game state variables
        let cookies = 0;
        let autoClickers = 0;
        let grandmas = 0;
        let ovens = 0; // New upgrade count
        let cookiesPerSecond = 0;

        // Initial costs (will be reset to these values)
        const initialAutoClickerCost = 10;
        const initialGrandmaCost = 100;
        const initialOvenCost = 500;

        // Current costs (these change during gameplay)
        let autoClickerCost = initialAutoClickerCost;
        let grandmaCost = initialGrandmaCost;
        let ovenCost = initialOvenCost;

        // CPS values for each upgrade
        const autoClickerCps = 0.1; // Each auto clicker gives 0.1 cookies/sec
        const grandmaCps = 1; // Each grandma gives 1 cookie/sec
        const ovenCps = 5; // Each oven gives 5 cookies/sec

        // DOM elements
        const cookieButton = document.getElementById('cookie');
        const scoreDisplay = document.getElementById('score');
        const cpsDisplay = document.getElementById('cps-display');

        const autoClickerButton = document.getElementById('autoClickerButton');
        const autoClickerCountDisplay = document.getElementById('autoClickerCount');
        const autoClickerCostDisplay = document.getElementById('autoClickerCost');

        const grandmaButton = document.getElementById('grandmaButton');
        const grandmaCountDisplay = document.getElementById('grandmaCount');
        const grandmaCostDisplay = document.getElementById('grandmaCost');

        const ovenButton = document.getElementById('ovenButton');
        const ovenCountDisplay = document.getElementById('ovenCount');
        const ovenCostDisplay = document.getElementById('ovenCost');

        const resetButton = document.getElementById('resetButton'); // Get the new reset button

        /**
         * Saves the current game state to local storage.
         */
        function saveGame() {
            const gameState = {
                cookies: cookies,
                autoClickers: autoClickers,
                grandmas: grandmas,
                ovens: ovens,
                autoClickerCost: autoClickerCost,
                grandmaCost: grandmaCost,
                ovenCost: ovenCost
            };
            localStorage.setItem('cookieClickerGame', JSON.stringify(gameState));
        }

        /**
         * Loads game state from local storage.
         */
        function loadGame() {
            const savedState = localStorage.getItem('cookieClickerGame');
            if (savedState) {
                const parsedState = JSON.parse(savedState);
                cookies = parsedState.cookies || 0;
                autoClickers = parsedState.autoClickers || 0;
                grandmas = parsedState.grandmas || 0;
                ovens = parsedState.ovens || 0;
                autoClickerCost = parsedState.autoClickerCost || initialAutoClickerCost;
                grandmaCost = parsedState.grandmaCost || initialGrandmaCost;
                ovenCost = parsedState.ovenCost || initialOvenCost;
            }
        }

        /**
         * Resets the game to its initial state.
         */
        function resetGame() {
            if (cookies > 0) {
                submitScore('g13.html', Math.floor(cookies));
            }
            cookies = 0;
            autoClickers = 0;
            grandmas = 0;
            ovens = 0;
            cookiesPerSecond = 0; // Important to reset CPS as well
            autoClickerCost = initialAutoClickerCost;
            grandmaCost = initialGrandmaCost;
            ovenCost = initialOvenCost;

            localStorage.removeItem('cookieClickerGame'); // Clear saved data
            updateAllDisplays(); // Update all UI elements
            saveGame(); // Save the reset state
        }

        /**
         * Calculates and updates the total cookies per second (CPS).
         */
        function calculateCps() {
            cookiesPerSecond = (autoClickers * autoClickerCps) +
                (grandmas * grandmaCps) +
                (ovens * ovenCps);
        }

        /**
         * Updates the main score and CPS displays.
         */
        function updateScoreDisplay() {
            scoreDisplay.textContent = Math.floor(cookies).toLocaleString() + ' Cookies';
            cpsDisplay.textContent = cookiesPerSecond.toFixed(1) + ' Cookies/sec';
        }

        /**
         * Updates the display and enabled/disabled state of all upgrade buttons.
         */
        function updateUpgradeButtons() {
            autoClickerCountDisplay.textContent = autoClickers;
            autoClickerCostDisplay.textContent = autoClickerCost.toLocaleString();
            autoClickerButton.disabled = cookies < autoClickerCost;

            grandmaCountDisplay.textContent = grandmas;
            grandmaCostDisplay.textContent = grandmaCost.toLocaleString();
            grandmaButton.disabled = cookies < grandmaCost;

            ovenCountDisplay.textContent = ovens;
            ovenCostDisplay.textContent = ovenCost.toLocaleString();
            ovenButton.disabled = cookies < ovenCost;
        }

        /**
         * A helper function to call all necessary UI update functions.
         */
        function updateAllDisplays() {
            calculateCps();
            updateScoreDisplay();
            updateUpgradeButtons();
        }

        /**
         * Handles a cookie click event.
         * Increments cookies, updates displays, and shows a floating score animation.
         * @param {MouseEvent} event - The click event object.
         */
        cookieButton.addEventListener('click', (event) => {
            cookies++;
            updateAllDisplays();
            saveGame(); // Save game after manual click

            // Create floating score animation
            const floatingScore = document.createElement('div');
            floatingScore.textContent = '+1';
            floatingScore.className = 'floating-score';
            // Position the floating score relative to the click point on the page
            floatingScore.style.left = event.clientX + 'px';
            floatingScore.style.top = event.clientY - 20 + 'px'; // Offset slightly above click
            document.body.appendChild(floatingScore);

            // Remove the floating score element after its animation ends
            floatingScore.addEventListener('animationend', () => {
                floatingScore.remove();
            });
        });

        /**
         * Event listener for Auto Clicker purchase button.
         */
        autoClickerButton.addEventListener('click', () => {
            if (cookies >= autoClickerCost) {
                cookies -= autoClickerCost;
                autoClickers++;
                autoClickerCost = Math.ceil(autoClickerCost * 1.5); // Increase cost
                updateAllDisplays(); // Update all displays after purchase
                saveGame(); // Save game after purchase
            }
        });

        /**
         * Event listener for Grandma purchase button.
         */
        grandmaButton.addEventListener('click', () => {
            if (cookies >= grandmaCost) {
                cookies -= grandmaCost;
                grandmas++;
                grandmaCost = Math.ceil(grandmaCost * 1.5); // Increase cost
                updateAllDisplays(); // Update all displays after purchase
                saveGame(); // Save game after purchase
            }
        });

        /**
         * Event listener for Oven purchase button (new upgrade).
         */
        ovenButton.addEventListener('click', () => {
            if (cookies >= ovenCost) {
                cookies -= ovenCost;
                ovens++;
                ovenCost = Math.ceil(ovenCost * 1.5); // Increase cost
                updateAllDisplays(); // Update all displays after purchase
                saveGame(); // Save game after purchase
            }
        });

        /**
         * Event listener for the Reset Game button.
         */
        resetButton.addEventListener('click', resetGame);

        /**
         * Game loop: adds cookies from passive income and updates UI.
         */
        setInterval(() => {
            cookies += cookiesPerSecond;
            updateAllDisplays(); // Update all displays periodically
            saveGame(); // Save game state periodically
        }, 1000); // Update every second

        // Initial setup on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadGame(); // Load game state
            updateAllDisplays(); // Initial update of all displays
        });
    </script>
</body>

</html>